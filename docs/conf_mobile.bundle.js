!function(e){function t(t){for(var i,o,s=t[0],c=t[1],l=t[2],u=0,m=[];u<s.length;u++)o=s[u],a[o]&&m.push(a[o][0]),a[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(d&&d(t);m.length;)m.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],i=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(i=!1)}i&&(n.splice(t--,1),e=o(o.s=r[0]))}return e}var i={},a={1:0},n=[];function o(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=i,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=c;n.push([29,0]),r()}([,,,function(e,t,r){"use strict";t.a={setMuteVideoTracks:function(e,t){e.getVideoTracks().forEach(e=>e.enabled=!t)},setMuteAudioTracks:function(e,t){e.getAudioTracks().forEach(e=>e.enabled=!t)},setMuteTrack:function(e,t){e.enabled=!t},stopStream:function(e){e.getTracks().forEach(e=>e.stop())},getUserDevices:async function(){const e={video:[],audio:[]},t=await navigator.mediaDevices.enumerateDevices();for(const r of t)"videoinput"===r.kind&&e.video.push(r),"audioinput"===r.kind&&e.audio.push(r);return e},getUserMedia:function({videoDeviceId:e,audioDeviceId:t},r){const i={video:{deviceId:e},audio:{deviceId:t}};return""===e&&(i.video=!1),""===t&&(i.audio=!1),["user","environment"].includes(r)&&(i.video.facingMode=r),navigator.mediaDevices.getUserMedia(i)},snapVideoStream:function(e,t="image/jpeg",r=1){return new Promise(i=>{let a=document.createElement("video");a.addEventListener("loadeddata",()=>{let e=document.createElement("canvas");e.width=a.videoWidth,e.height=a.videoHeight,e.getContext("2d").drawImage(a,0,0),e.toBlob(t=>{a.pause(),a.srcObject=null,a=e=null,i(t)},t,r)},{once:!0}),a.autoplay=a.muted=a.playsInline=!0,a.srcObject=e})},getFakeStream:function(e){const{stream:t}=e.createMediaStreamDestination();return t}}},function(e,t,r){"use strict";let i=null;t.a={getOsName:function(e){switch(!0){case/Android/.test(e):return"Android";case/iPhone|iPad|iPod/.test(e):return"iOS";case/Windows/.test(e):return"Windows";case/Mac OS X/.test(e):return"Mac";case/CrOS/.test(e):return"CromeOS";case/Firefox/.test(e):return"FirefoxOS";default:return""}},getBrowserName:function(e){switch(!0){case/CriOS/.test(e):return"iOSChrome";case/Edge/.test(e):return"Edge";case/Chrome/.test(e):return"Chrome";case/Firefox/.test(e):return"Firefox";case/MSIE|Trident/.test(e):return"IE";case/Safari\//.test(e):return"Safari";case/AppleWebKit/.test(e):return"Webkit";default:return""}},getAudioCtx:function(e){if(null!==i)return i;const t=new(e.webkitAudioContext||e.AudioContext);return i=t},setLocationHref:function(e){location.href=e}}},function(e,t,r){"use strict";var i=r(0),a=r.n(i);t.a=(({isMuted:e=!1,isSelf:t=!1})=>a.a.createElement("i",{className:`material-icons ${t&&e?"-muted":""}`},e?"mic_off":"mic"))},function(e,t,r){"use strict";var i=r(0),a=r.n(i);t.a=(({isMuted:e=!1,isSelf:t=!1})=>a.a.createElement("i",{className:`material-icons ${t&&e?"-muted":""}`},e?"videocam_off":"videocam"))},,function(e,t,r){"use strict";t.a={isValidRoomType:function(e){return"sfu"===e||"mesh"===e},isValidRoomName:function(e){return/^[0-9a-z_-]{4,32}$/.test(e)}}},function(e,t,r){"use strict";var i=r(0),a=r.n(i);t.a=(({isSpeaking:e=!1})=>a.a.createElement("i",{className:`material-icons ${e?"-speaking":"-not_speaking"}`},"equalizer"))},function(e,t,r){"use strict";t.a=class{constructor(e){this.store=e}$update(e,t){const[r,i]=e.split(".");if(!(r&&i&&r in this.store&&i in this.store[r]))throw new Error(`${r}.${i} is not defined!`);this.store[r][i]=t}}},function(e,t,r){"use strict";const i=window.Peer,a=window.ScreenShare;t.a={initPeer:function(){return new Promise((e,t)=>{const r=new i({key:"03ff6219-b58f-4310-9484-e9108e859cdd",debug:2});r.once("open",()=>{e(r),r.removeListener("error",t)}),r.once("error",t)})},isScreenShareAvailable:function(){return a.create().isScreenShareAvailable()},getScreenStreamTrack:function(e){return new Promise((t,r)=>{a.create().start(e).then(e=>t(e.getTracks()[0])).catch(r)})}}},function(e,t,r){"use strict";e.exports=function(e){var t=(e?e.ownerDocument||e:document).defaultView||window;return!(!e||!("function"==typeof t.Node?e instanceof t.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}},function(e,t,r){"use strict";var i=r(12);e.exports=function(e){return i(e)&&3==e.nodeType}},function(e,t,r){"use strict";var i=r(20);e.exports=function(e,t,r){r=r||{};var a={fftSize:1024,bufferLen:1024,smoothingTimeConstant:.2,minCaptureFreq:85,maxCaptureFreq:255,noiseCaptureDuration:1e3,minNoiseLevel:.3,maxNoiseLevel:.7,avgNoiseMultiplier:1.2,onVoiceStart:function(){},onVoiceStop:function(){},onUpdate:function(e){}},n={};for(var o in a)n[o]=r.hasOwnProperty(o)?r[o]:a[o];var s=0,c=1,l=0,d=0,u=60,m=5,h=[],p=!0,f=void 0,v=!1,E=null,g=e.createMediaStreamSource(t),b=e.createAnalyser();b.smoothingTimeConstant=n.smoothingTimeConstant,b.fftSize=n.fftSize;var S=e.createScriptProcessor(n.bufferLen,1,1);function y(){g.connect(b),b.connect(S),S.connect(e.destination)}function N(){S.disconnect(),b.disconnect(),g.disconnect()}return y(),S.onaudioprocess=function(){var e=new Uint8Array(b.frequencyBinCount);b.getByteFrequencyData(e);var t=i(b,e,n.minCaptureFreq,n.maxCaptureFreq);if(p)return void h.push(t);t>=s&&l<u?l++:t<s&&l>d&&l--;f!==(v=l>m)&&(v?n.onVoiceStart():n.onVoiceStop(),f=v);n.onUpdate(Math.max(0,t-s)/c)},p&&(E=setTimeout(function(){p=!1;var e=(h=h.filter(function(e){return e}).sort()).length?h.reduce(function(e,t){return Math.min(e,t)},1):n.minNoiseLevel||.1;s=e*n.avgNoiseMultiplier,n.minNoiseLevel&&s<n.minNoiseLevel&&(s=n.minNoiseLevel);n.maxNoiseLevel&&s>n.maxNoiseLevel&&(s=n.maxNoiseLevel);c=1-s},n.noiseCaptureDuration)),{connect:y,disconnect:N,destroy:function(){E&&clearTimeout(E),N(),S.onaudioprocess=null}}}},function(e,t,r){"use strict";function i(e){return function(){return e}}var a=function(){};a.thatReturns=i,a.thatReturnsFalse=i(!1),a.thatReturnsTrue=i(!0),a.thatReturnsNull=i(null),a.thatReturnsThis=function(){return this},a.thatReturnsArgument=function(e){return e},e.exports=a},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,o,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in r=Object(arguments[c]))a.call(r,l)&&(s[l]=r[l]);if(i){o=i(r);for(var d=0;d<o.length;d++)n.call(r,o[d])&&(s[o[d]]=r[o[d]])}}return s}},function(e,t){e.exports=function(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}},function(e,t,r){var i=r(18);e.exports=function(e,t,r){var a=t/2,n=Math.round(e/a*r);return i(n,0,r)}},function(e,t,r){var i=r(19);function a(e,t,r,a,n){for(var o=t.context.sampleRate,s=t.frequencyBinCount,c=i(a,o,s),l=i(n,o,s),d=l-c,u=0;c<l;c++)u+=r[c]/e;return 0===d?0:u/d}e.exports=a.bind(null,255),e.exports.floatData=a.bind(null,1)},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r,i,a=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===n||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:n}catch(e){r=n}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,l=[],d=!1,u=-1;function m(){d&&c&&(d=!1,c.length?l=c.concat(l):u=-1,l.length&&h())}function h(){if(!d){var e=s(m);d=!0;for(var t=l.length;t;){for(c=l,l=[];++u<t;)c&&c[u].run();u=-1,t=l.length}c=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||d||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=f,a.addListener=f,a.once=f,a.off=f,a.removeListener=f,a.removeAllListeners=f,a.emit=f,a.prependListener=f,a.prependOnceListener=f,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,r){"use strict";var i=r(13);e.exports=function e(t,r){return!(!t||!r)&&(t===r||!i(t)&&(i(r)?e(t,r.parentNode):"contains"in t?t.contains(r):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(r))))}},function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty;function a(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}e.exports=function(e,t){if(a(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!i.call(t,r[o])||!a(e[r[o]],t[r[o]]))return!1;return!0}},function(e,t,r){"use strict";e.exports=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}},function(e,t,r){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),a={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};e.exports=a},,,function(e,t,r){"use strict";r.r(t);var i=r(0),a=r.n(i),n=r(7),o=r.n(n),s=r(2),c=r(1),l=r(8);class d{constructor(){this.roomType="",this.roomName="",this.isAppReady=!1,this.isWelcomeOpen=!0,this.isSettingOpen=!0,this.isChatOpen=!1,this.isRoomJoin=!1,this.isUserError=!1,this.isAppError=!1}get confUrl(){const e=`#!/${this.roomType}/${this.roomName}`;return`${location.origin}${location.pathname}${e}`}get isError(){return this.isUserError||this.isAppError}setRoom({roomType:e,roomName:t}){l.a.isValidRoomName(t)&&l.a.isValidRoomType(e)?(this.roomType=e,this.roomName=t):this.isUserError=!0}handleGetUserMediaError(e){switch(e.name){case"OverconstrainedError":case"NotFoundError":this.isAppError=!0;break;default:this.isUserError=!0}console.error(e)}handleAppError(e){this.isAppError=!0,console.error(e)}handleUserError(e){this.isUserError=!0,console.error(e)}}Object(c.g)(d,{roomType:c.l,roomName:c.l,isAppReady:c.l,isWelcomeOpen:c.l,isSettingOpen:c.l,isChatOpen:c.l,isRoomJoin:c.l,isUserError:c.l,isAppError:c.l,confUrl:c.d,isError:c.d});var u=d;class m{constructor(){this.peerId="YOUR_PEER_ID",this.dispName="YOUR_NAME",this.isVideoMuted=!1,this.isAudioMuted=!1,this.isSpeaking=!1,this.videoDeviceId="",this.audioDeviceId="",this.videoDevices=[],this.audioDevices=[]}get facingMode(){return 2!==this.videoDevices.length?"environment":this.videoDeviceId===this.videoDevices[1].deviceId?"user":"environment"}get syncState(){return{peerId:this.peerId,dispName:this.dispName,isVideoMuted:this.isVideoMuted,isAudioMuted:this.isAudioMuted,isSpeaking:this.isSpeaking}}get isNoVideoDevices(){return 0===this.videoDevices.length}get isNoAudioDevices(){return 0===this.audioDevices.length}updateDevices({video:e,audio:t}){this.videoDevices=e,this.audioDevices=t,this._setDefaultDeviceIfNeeded()}_setDefaultDeviceIfNeeded(){const e=this.videoDevices.find(e=>e.deviceId===this.videoDeviceId),t=this.audioDevices.find(e=>e.deviceId===this.audioDeviceId);!1===this.isNoVideoDevices&&(e||(this.videoDeviceId=this.videoDevices[0].deviceId)),!1===this.isNoAudioDevices&&(t||(this.audioDeviceId=this.audioDevices[0].deviceId))}}Object(c.g)(m,{peerId:c.l,dispName:c.l,isVideoMuted:c.l,isAudioMuted:c.l,isSpeaking:c.l,videoDeviceId:c.l,audioDeviceId:c.l,videoDevices:c.l.ref,audioDevices:c.l.ref,syncState:c.d,facingMode:c.d,isNoVideoDevices:c.d,isNoAudioDevices:c.d,updateDevices:c.c,_setDefaultDeviceIfNeeded:c.c});var h=m;class p{constructor(){this.syncState=new Map,this.pinnedPeerId="",this.localStream={},this.remoteStreams=[]}get pinnedPeerIdDisp(){return 0!==this.pinnedPeerId.length?this.pinnedPeerId:0!==this.remoteStreams.length?this.remoteStreams[0].peerId:""}get pinnedStream(){const e=this.remoteStreams.find(e=>e.peerId===this.pinnedPeerIdDisp);return e||(0!==this.remoteStreams.length?this.remoteStreams[0]:null)}setLocalStream(e){this.localStream=e}addRemoteStream(e){const t=this.remoteStreams.find(t=>t.peerId===e.peerId);this.removeRemoteStream(t),this.remoteStreams.push(e)}removeRemoteStreamByPeerId(e){const t=this.remoteStreams.find(t=>t.peerId===e);this.removeRemoteStream(t),this.syncState.delete(e),this.pinnedPeerId===e&&(this.pinnedPeerId="")}removeRemoteStream(e){e&&this.remoteStreams.remove(e)}}Object(c.g)(p,{syncState:c.l,pinnedPeerId:c.l,localStream:c.l.ref,remoteStreams:c.l.shallow,pinnedPeerIdDisp:c.d,pinnedStream:c.d,setLocalStream:c.c,addRemoteStream:c.c,removeRemoteStreamByPeerId:c.c,removeRemoteStream:c.c});var f=p;class v{constructor(){this.bufferText="",this.lastMessage={},this.messages=[]}addMessage({text:e,timestamp:t,peerId:r},i,a){this.messages.push({id:`${r}-${t}`,text:e,dispDate:new Date(t).toLocaleTimeString().slice(0,5),thumb:i,dispName:a})}updateBuffer(e){this.lastMessage=e,this.bufferText=""}}Object(c.g)(v,{bufferText:c.l,lastMessage:c.l.ref,messages:c.l.shallow,updateBuffer:c.c});var E=v;class g{constructor(){this.items=[]}showChat(e){this._show(`${e.dispName} sent a chat`)}showJoin(e){this._show(`${e.dispName} joined`)}showLeave(e){this._show(`${e.dispName} left`)}_show(e){const t={id:Date.now(),text:e};this.items.push(t),setTimeout(()=>this.items.remove(t),1e3)}}Object(c.g)(g,{items:c.l.shallow});var b=g;var S=class{constructor(){this.ui=new u,this.user=new h,this.room=new f,this.chat=new E,this.notification=new b}},y=r(14),N=r.n(y),w=r(10),_=r(3),O=r(11),M=r(4);var D=class extends w.a{constructor(e){super(e),this._destroyVad=null;const{user:t,room:r,ui:i}=this.store;Object(c.m)(()=>[t.videoDeviceId,t.audioDeviceId],async([e,a])=>{const n=await _.a.getUserMedia({videoDeviceId:e,audioDeviceId:a},t.facingMode).catch(e=>i.handleGetUserMediaError(e));i.isError||(r.localStream instanceof MediaStream&&_.a.stopStream(r.localStream),i.isAppReady=!0,t.isVideoMuted&&_.a.setMuteVideoTracks(n,!0),t.isAudioMuted&&_.a.setMuteAudioTracks(n,!0),r.setLocalStream(n))}),Object(c.m)(()=>t.isVideoMuted,e=>_.a.setMuteVideoTracks(r.localStream,e)),Object(c.m)(()=>t.isAudioMuted,e=>_.a.setMuteAudioTracks(r.localStream,e)),Object(c.m)(()=>t.dispName,e=>localStorage.setItem("SkyWayConf.dispName",e)),Object(c.p)(()=>i.isAppReady,async()=>{const e=await _.a.getUserDevices().catch(e=>i.handleUserError(e));i.isError||t.updateDevices(e)})}onClickWelcomeClose(){const{ui:e,user:t,room:r}=this.store;e.isWelcomeOpen=!1,Object(c.m)(()=>r.localStream,e=>{this._destroyVad&&this._destroyVad();const{destroy:r}=N()(M.a.getAudioCtx(window),e,{onUpdate(e){t.isSpeaking=0!==e}});this._destroyVad=r},{fireImmediately:!0})}async onLoad({roomType:e,roomName:t}){const{user:r,ui:i,room:a}=this.store;i.setRoom({roomType:e,roomName:t});const n=localStorage.getItem("SkyWayConf.dispName");n&&(r.dispName=n);const o=await _.a.getUserDevices().catch(e=>i.handleUserError(e));if(!i.isError){if(r.updateDevices(o),r.isNoVideoDevices&&r.isNoAudioDevices){i.isAppReady=!0;const e=_.a.getFakeStream(M.a.getAudioCtx(window));a.setLocalStream(e)}navigator.mediaDevices.ondevicechange=async function(){const e=await _.a.getUserDevices().catch(e=>i.handleUserError(e));i.isError||r.updateDevices(e)}}}async onClickJoinRoom(){const{ui:e,room:t,user:r}=this.store,i=await O.a.initPeer().catch(t=>e.handleAppError(t));if(e.isError)return;i.on("error",t=>e.handleSkyWayPeerError(t)),r.peerId=i.id;const a=i.joinRoom(`${e.roomType}/${e.roomName}`,{mode:e.roomType,stream:t.localStream});this._onRoomJoin(a),e.isSettingOpen=!1}async onClickSendChat(){const{chat:e,user:t,room:r,ui:i}=this.store,a=await _.a.snapVideoStream(r.localStream,"image/jpeg",.5).catch(e=>i.handleAppError(e));if(i.isError)return;const n={peerId:t.peerId,text:e.bufferText,blob:a,timestamp:Date.now()},o=URL.createObjectURL(a);e.addMessage(n,o,t.dispName),e.updateBuffer(n)}_onRoomJoin(e){const{ui:t,user:r,room:i,chat:a}=this.store;t.isRoomJoin=!0,e.on("stream",t=>this._onRoomAddStream(t,e)),e.on("removeStream",e=>this._onRoomRemoveStream(e)),e.on("peerLeave",e=>this._onRoomPeerLeave(e)),e.on("data",e=>this._onRoomData(e)),Object(c.m)(()=>i.localStream,()=>e.replaceStream(i.localStream)),Object(c.m)(()=>r.syncState,t=>e.send({type:"sync",payload:t})),Object(c.m)(()=>a.lastMessage,t=>e.send({type:"chat",payload:t}))}_onRoomAddStream(e,t){const{room:r,user:i,notification:a}=this.store;r.addRemoteStream(e),t.send({type:"sync",payload:i.syncState}),Object(c.p)(()=>void 0!==r.syncState.get(e.peerId),()=>a.showJoin(r.syncState.get(e.peerId)))}_onRoomRemoveStream(e){const{room:t}=this.store;t.removeRemoteStream(e)}_onRoomPeerLeave(e){const{room:t,notification:r}=this.store,i=t.syncState.get(e);r.showLeave(i),t.removeRemoteStreamByPeerId(e)}_onRoomData({_src:e,data:t}){const{room:r,chat:i,ui:a,notification:n}=this.store,{type:o,payload:s}=t;switch(o){case"sync":r.syncState.set(s.peerId,s);break;case"chat":{const e=r.syncState.get(s.peerId),t=new Blob([new Uint8Array(s.blob)]),o=URL.createObjectURL(t);i.addMessage(s,o,e.dispName),a.isChatOpen||n.showChat(e);break}default:throw new Error(`${o} is not defined as message type`)}}};var I=()=>a.a.createElement("div",{className:"Loader"},a.a.createElement("img",{className:"Loader_Image",src:"./images/conf/icon-loading.svg",alt:"Loading"}));var C=Object(s.c)(({ui:e})=>a.a.createElement("div",{className:"Error"},a.a.createElement("div",{className:"Error_Title"},a.a.createElement("i",{className:"material-icons"},"error"),a.a.createElement("span",null,"Error")),e.isUserError&&a.a.createElement("div",{className:"Error_Desc"},a.a.createElement("p",null,"Please check your.."),a.a.createElement("ul",null,a.a.createElement("li",null,"current url(and hash)"),a.a.createElement("li",null,"camera or microphone settings"),a.a.createElement("li",null,"network conditions"),a.a.createElement("li",null,"browser updates"))),e.isAppError&&a.a.createElement("div",{className:"Error_Desc"},a.a.createElement("p",null,"Sorry, currently our service is not available. Please try it later."))));var j=Object(s.b)("ui","action")(Object(s.c)(class extends a.a.Component{render(){const{ui:e,children:t}=this.props;return e.isError?a.a.createElement(C,{ui:e}):e.isAppReady?t:a.a.createElement(I,null)}componentDidCatch(e){this.props.action.$update("ui.isAppError",!0),console.error(e)}}));var k=Object(s.c)(class extends a.a.Component{constructor(){super(),this._vRef=null,this._aRef=null}render(){const{muted:e,isMirror:t,stream:r}=this.props;return a.a.createElement(a.a.Fragment,null,a.a.createElement("video",{className:`Video ${t?"-reverse":""}`,ref:e=>{this._vRef=e},muted:!0,autoPlay:!0,playsInline:!0}),a.a.createElement("audio",{ref:e=>{this._aRef=e},muted:e,autoPlay:!0}))}componentDidMount(){this._vRef&&this._aRef&&this.props.stream instanceof MediaStream&&(this._vRef.srcObject=this._aRef.srcObject=this.props.stream)}componentWillReact(){this._vRef&&this._aRef&&this.props.stream instanceof MediaStream&&(this._vRef.srcObject=this._aRef.srcObject=this.props.stream)}});var L=Object(s.c)(({room:e})=>a.a.createElement("div",{className:"ScreenVideo"},e.pinnedStream?a.a.createElement(k,{stream:e.pinnedStream,muted:!0}):null));var A=Object(s.b)("room")(Object(s.c)(({room:e})=>a.a.createElement(L,{room:e})));var R=class extends a.a.Component{constructor(){super(),this._ref=null,this._disposer=null,this._checkListWidth=this._checkListWidth.bind(this)}render(){return a.a.createElement("div",{className:"MemberList"},a.a.createElement("div",{className:"MemberList_Arrow -left"},a.a.createElement("i",{className:"material-icons"},"chevron_left")),a.a.createElement("div",{ref:e=>this._ref=e,className:"MemberList_Scroller"},this.props.children),a.a.createElement("div",{className:"MemberList_Arrow -right"},a.a.createElement("i",{className:"material-icons"},"chevron_right")))}componentDidMount(){const{room:e}=this.props;this._disposer=Object(c.m)(()=>e.remoteStreams.length,()=>this._checkListWidth(),{fireImmediately:!0,delay:500}),window.addEventListener("resize",this._checkListWidth)}componentWillUnmount(){this._disposer(),window.removeEventListener("resize",this._checkListWidth)}_checkListWidth(){parseInt(getComputedStyle(this._ref).width)<Array.from(this._ref.children).reduce((e,t)=>e+parseInt(getComputedStyle(t).width),0)?this._ref.parentElement.classList.add("-scrollable"):this._ref.parentElement.classList.remove("-scrollable")}},T=r(6),x=r(5);var V=Object(s.c)(({user:e,action:t})=>a.a.createElement("div",{className:"MemberVideo"},a.a.createElement("div",{className:"MemberVideo_Local"},a.a.createElement("button",{onClick:()=>t.$update("user.isVideoMuted",!e.isVideoMuted),title:e.isVideoMuted?"Unmute":"Mute"},a.a.createElement(T.a,{isMuted:e.isVideoMuted,isSelf:!0})),a.a.createElement("button",{onClick:()=>t.$update("user.isAudioMuted",!e.isAudioMuted),title:e.isAudioMuted?"Unmute":"Mute"},a.a.createElement(x.a,{isMuted:e.isAudioMuted,isSelf:!0})),a.a.createElement("button",{onClick:()=>t.$update("ui.isSettingOpen",!0),title:"Open settings"},a.a.createElement("i",{className:"material-icons"},"settings")),a.a.createElement("button",{onClick:()=>t.$update("ui.isChatOpen",!0),title:"Open chat"},a.a.createElement("i",{className:"material-icons"},"chat"))))),P=r(9);var U=Object(s.c)(({room:e,action:t})=>a.a.createElement(a.a.Fragment,null,e.remoteStreams.map(r=>{const i=e.syncState.get(r.peerId);return a.a.createElement("div",{key:r.id,className:"MemberVideo",onClick:()=>t.$update("room.pinnedPeerId",r.peerId)},e.pinnedPeerIdDisp===r.peerId&&a.a.createElement("div",{className:"MemberVideo_Pinned"}),i?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"MemberVideo_Name"},i.dispName),a.a.createElement("div",{className:"MemberVideo_Media"},i.isVideoMuted&&a.a.createElement(T.a,{isMuted:!0}),i.isAudioMuted&&a.a.createElement(x.a,{isMuted:!0}),i.isSpeaking&&a.a.createElement(P.a,{isSpeaking:!0}))):null,a.a.createElement(k,{stream:r}))})));var $=Object(s.b)("room","user","action")(Object(s.c)(({room:e,user:t,action:r})=>a.a.createElement(R,{room:e},a.a.createElement(V,{user:t,action:r}),a.a.createElement(U,{room:e,action:r}))));const W=({isVisible:e,children:t})=>a.a.createElement("div",{className:"Popup",style:{transform:e?"translate3d(0, 0, 0)":"translate3d(0, -100%, 0)",visibility:e?"visible":"hidden"}},t),F=({isVisible:e,children:t})=>e?a.a.createElement("div",{className:"Popup"},t):null;var B=Object(s.c)(({isVisible:e,noAnim:t=!1,children:r})=>t?a.a.createElement(F,{isVisible:e},r):a.a.createElement(W,{isVisible:e},r));var J=Object(s.c)(({ui:e,room:t})=>a.a.createElement(k,{stream:t.localStream,muted:!0,isMirror:!1===e.isScreenSharing}));var q=Object(s.c)(({user:e,action:t})=>a.a.createElement("div",{className:"DeviceSelector"},a.a.createElement("div",{className:"DeviceSelector_Label"},"Cam / Mic"),a.a.createElement("div",{className:"DeviceSelector_Row"},a.a.createElement("select",{className:"DeviceSelector_Select",value:e.videoDeviceId,onChange:e=>t.$update("user.videoDeviceId",e.target.value),disabled:e.isNoVideoDevices},e.isNoVideoDevices&&a.a.createElement("option",{value:""},"Cam not found"),e.videoDevices.map((e,t)=>a.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||`Cam ${t+1}`))),a.a.createElement("button",{onClick:()=>t.$update("user.isVideoMuted",!e.isVideoMuted),title:e.isVideoMuted?"Unmute":"Mute"},a.a.createElement(T.a,{isMuted:e.isVideoMuted,isSelf:!0}))),a.a.createElement("div",{className:"DeviceSelector_Row"},a.a.createElement("select",{className:"DeviceSelector_Select",value:e.audioDeviceId,onChange:e=>t.$update("user.audioDeviceId",e.target.value),disabled:e.isNoAudioDevices},e.isNoAudioDevices&&a.a.createElement("option",{value:""},"Mic not found"),e.audioDevices.map((e,t)=>a.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||`Mic ${t+1}`))),a.a.createElement("button",{onClick:()=>t.$update("user.isAudioMuted",!e.isAudioMuted),title:e.isAudioMuted?"Unmute":"Mute"},a.a.createElement(x.a,{isMuted:e.isAudioMuted,isSelf:!0})),a.a.createElement("span",{className:"DeviceSelector_Va"},a.a.createElement(P.a,{isSpeaking:e.isSpeaking})))));var z=Object(s.c)(({user:e,action:t})=>a.a.createElement("div",{className:"NameEdit"},a.a.createElement("div",{className:"NameEdit_Label"},"Name"),a.a.createElement("input",{className:"NameEdit_Input",type:"text",maxLength:10,value:e.dispName,onChange:e=>t.$update("user.dispName",e.target.value)})));var H=Object(s.b)("room","ui","user","action")(Object(s.c)(({room:e,ui:t,user:r,action:i})=>a.a.createElement(B,{isVisible:t.isSettingOpen},a.a.createElement("div",{className:"L-Setting"},a.a.createElement("div",{className:"L-Setting_Video"},a.a.createElement(J,{ui:t,room:e})),a.a.createElement(q,{user:r,action:i}),a.a.createElement(z,{user:r,action:i}),a.a.createElement("div",{className:"L-Setting_Finish"},a.a.createElement("button",{onClick:()=>{t.isRoomJoin?i.$update("ui.isSettingOpen",!1):i.onClickJoinRoom()}},"OK"))))));var K=Object(s.c)(class extends a.a.Component{constructor(){super(),this._ref=null}render(){const{chat:e}=this.props;return a.a.createElement("ul",{className:"ChatMessageList",ref:e=>this._ref=e},e.messages.map(e=>a.a.createElement("li",{key:e.id},a.a.createElement("div",{className:"ChatMessageList_Item"},a.a.createElement("div",{className:"ChatMessageList_Item_Thumb"},a.a.createElement("img",{className:"ChatMessageList_Item_Thumb_Image",src:e.thumb})),a.a.createElement("div",{className:"ChatMessageList_Item_Content"},a.a.createElement("div",{className:"ChatMessageList_Item_Content_Head"},a.a.createElement("span",{className:"ChatMessageList_Item_Content_HeadName"},e.dispName),a.a.createElement("span",{className:"ChatMessageList_Item_Content_HeadDate"},"at ",e.dispDate)),a.a.createElement("p",{className:"ChatMessageList_Item_Content_Body"},e.text))))))}componentWillReact(){this._ref&&requestAnimationFrame(()=>this._ref.scrollTop=this._ref.scrollHeight)}});var G=Object(s.c)(({chat:e,action:t})=>a.a.createElement("div",{className:"ChatBox"},a.a.createElement("button",{className:"ChatBox_Closer",onClick:()=>t.$update("ui.isChatOpen",!1)},a.a.createElement("i",{className:"material-icons -x05"},"close")),a.a.createElement(K,{chat:e}),a.a.createElement("div",{className:"ChatBox_Action"},a.a.createElement("input",{className:"ChatBox_Action_Input",type:"text",placeholder:"Type messages here...",value:e.bufferText,onChange:e=>t.$update("chat.bufferText",e.target.value)}),a.a.createElement("button",{disabled:0===e.bufferText.length,onClick:()=>t.onClickSendChat()},"Send"))));var Y=Object(s.b)("ui","chat","action")(Object(s.c)(({ui:e,chat:t,action:r})=>a.a.createElement(B,{isVisible:e.isChatOpen},a.a.createElement(G,{ui:e,chat:t,action:r}))));var X=Object(s.b)("ui","action")(Object(s.c)(({ui:e,action:t})=>a.a.createElement(B,{isVisible:e.isWelcomeOpen,noAnim:!0},a.a.createElement("div",{className:"L-Welcome"},a.a.createElement("h3",{className:"L-Welcome_Header"},"SkyWayConferenceMobile"),a.a.createElement("p",{className:"L-Welcome_Messages"},"This site plays sound.",a.a.createElement("br",null),"And this site uses your camera and microphone until closing tab."),a.a.createElement("div",{className:"L-Welcome_Finish"},a.a.createElement("button",{onClick:()=>t.onClickWelcomeClose()},"OK"))))));var Q=Object(s.c)(({notification:e})=>a.a.createElement(a.a.Fragment,null,e.items.map(e=>a.a.createElement("div",{className:"Toast",key:e.id},e.text))));var Z=Object(s.b)("notification")(Object(s.c)(({notification:e})=>a.a.createElement("div",{className:"L-Notification"},a.a.createElement(Q,{notification:e}))));var ee=()=>a.a.createElement(j,null,a.a.createElement("main",{className:"L-Main"},a.a.createElement(A,null),a.a.createElement($,null)),a.a.createElement(H,null),a.a.createElement(Y,null),a.a.createElement(X,null),a.a.createElement(Z,null)),te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};!function(){const[,e,t]=location.hash.split("/"),r=M.a.getOsName(navigator.userAgent),i=M.a.getBrowserName(navigator.userAgent);if(!1===(["Windows","Mac","iOS","Android"].includes(r)&&["Chrome","Firefox","Safari"].includes(i))||"Safari"===i&&"mesh"!==e)return void(location.href="./not_supported.html");if(!1===["iOS","Android"].includes(r))return void(location.href=`./conf.html${location.hash}`);if(/iPod/.test(navigator.userAgent))return void(location.href="./not_supported.html");const n=new S,c=new D(n);c.onLoad({roomType:e,roomName:t}),o.a.render(a.a.createElement(s.a,te({action:c},n),a.a.createElement(ee,null)),document.getElementById("app-root")),window.addEventListener("hashchange",()=>location.reload(!0))}()}]);