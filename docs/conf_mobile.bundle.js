!function(e){function t(t){for(var a,o,s=t[0],c=t[1],l=t[2],d=0,m=[];d<s.length;d++)o=s[d],r[o]&&m.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(u&&u(t);m.length;)m.shift()();return n.push.apply(n,l||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],a=!0,s=1;s<i.length;s++){var c=i[s];0!==r[c]&&(a=!1)}a&&(n.splice(t--,1),e=o(o.s=i[0]))}return e}var a={},r={2:0},n=[];function o(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=a,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(i,a,function(t){return e[t]}.bind(null,a));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;n.push([25,0]),i()}([,,,function(e,t,i){"use strict";t.a={setMuteVideoTracks:function(e,t){e.getVideoTracks().forEach(e=>e.enabled=!t)},setMuteAudioTracks:function(e,t){e.getAudioTracks().forEach(e=>e.enabled=!t)},setMuteTrack:function(e,t){e.enabled=!t},stopStream:function(e){e.getTracks().forEach(e=>e.stop())},getUserPermission:function(){return navigator.mediaDevices.getUserMedia({video:!0,audio:!0})},getUserDevices:async function(){const e={video:[],audio:[]},t=await navigator.mediaDevices.enumerateDevices();for(const i of t)"videoinput"===i.kind&&e.video.push(i),"audioinput"===i.kind&&e.audio.push(i);return e},getUserMedia:function({videoDeviceId:e,audioDeviceId:t},i){const a={video:{deviceId:{exact:e}},audio:{deviceId:{exact:t}}};return""===e&&(a.video=!1),""===t&&(a.audio=!1),["user","environment"].includes(i)&&(a.video.facingMode=i),navigator.mediaDevices.getUserMedia(a)},isGetDisplayMediaAvailable:function(){return"function"==typeof navigator.mediaDevices.getDisplayMedia},getDisplayStreamTrack:function(){return navigator.mediaDevices.getDisplayMedia({video:!0}).then(e=>e.getTracks()[0])},snapVideoStream:function(e,t="image/jpeg",i=1){return new Promise(async(a,r)=>{let n=document.createElement("video");n.muted=n.playsInline=!0,n.srcObject=e,await n.play().catch(r);let o=document.createElement("canvas");o.width=n.videoWidth,o.height=n.videoHeight,o.getContext("2d").drawImage(n,0,0),o.toBlob(e=>{n.pause(),n.srcObject=null,n=o=null,a(e)},t,i)})},getFakeStream:function(e){const t=document.createElement("canvas");t.width=t.height=1,t.getContext("2d");const i=t.captureStream(),a=e.createMediaStreamDestination().stream,[r]=i.getVideoTracks(),[n]=a.getAudioTracks();return new MediaStream([r,n])}}},function(e,t,i){"use strict";let a=null;t.a={getOsName:function(e){switch(!0){case/Android/.test(e):return"Android";case/iPhone|iPad|iPod/.test(e):return"iOS";case/Windows/.test(e):return"Windows";case/Mac OS X/.test(e):return"Mac";case/Linux/.test(e):return"Linux";case/CrOS/.test(e):return"CromeOS";case/Firefox/.test(e):return"FirefoxOS";default:return""}},getBrowserName:function(e){switch(!0){case/CriOS/.test(e):return"iOSChrome";case/Edge/.test(e):return"Edge";case/Chrome/.test(e):return"Chrome";case/Firefox/.test(e):return"Firefox";case/MSIE|Trident/.test(e):return"IE";case/Safari\//.test(e):return"Safari";case/AppleWebKit/.test(e):return"Webkit";default:return""}},getAudioCtx:function(e){if(null!==a)return a;const t=new(e.webkitAudioContext||e.AudioContext);return a=t},setLocationHref:function(e){location.href=e}}},function(e,t,i){"use strict";var a=i(0),r=i.n(a);t.a=(({isMuted:e=!1,isSelf:t=!1})=>r.a.createElement("i",{className:`material-icons ${t&&e?"-muted":""}`},e?"videocam_off":"videocam"))},function(e,t,i){"use strict";var a=i(0),r=i.n(a);t.a=(({isMuted:e=!1,isSelf:t=!1})=>r.a.createElement("i",{className:`material-icons ${t&&e?"-muted":""}`},e?"mic_off":"mic"))},,function(e,t,i){"use strict";t.a={isValidRoomType:function(e){return"sfu"===e||"mesh"===e},isValidRoomName:function(e){return/^[0-9a-z_-]{4,32}$/.test(e)}}},function(e,t,i){"use strict";var a=i(0),r=i.n(a);t.a=(({isSpeaking:e=!1})=>r.a.createElement("i",{className:`material-icons ${e?"-speaking":"-not_speaking"}`},"equalizer"))},function(e,t,i){"use strict";t.a=class{constructor(e){this.store=e}$update(e,t){const[i,a]=e.split(".");if(!(i&&a&&i in this.store&&a in this.store[i]))throw new Error(`${i}.${a} is not defined!`);this.store[i][a]=t}}},function(e,t,i){"use strict";const a=window.Peer,r=window.ScreenShare;t.a={initPeer:function(){return new Promise((e,t)=>{const i=new a({key:"03ff6219-b58f-4310-9484-e9108e859cdd",debug:2});i.once("open",()=>{e(i),i.removeListener("error",t)}),i.once("error",t)})},isScreenShareAvailable:function(){return r.create().isScreenShareAvailable()},getScreenStreamTrack:function(e){return new Promise((t,i)=>{r.create().start(e).then(e=>t(e.getTracks()[0])).catch(i)})}}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";(function(e){
/** @license React v0.13.6
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
Object.defineProperty(t,"__esModule",{value:!0});var i=null,a=!1,r=3,n=-1,o=-1,s=!1,c=!1;function l(){if(!s){var e=i.expirationTime;c?_():c=!0,w(m,e)}}function u(){var e=i,t=i.next;if(i===t)i=null;else{var a=i.previous;i=a.next=t,t.previous=a}e.next=e.previous=null,a=e.callback,t=e.expirationTime,e=e.priorityLevel;var n=r,s=o;r=e,o=t;try{var c=a()}finally{r=n,o=s}if("function"==typeof c)if(c={callback:c,priorityLevel:e,expirationTime:t,next:null,previous:null},null===i)i=c.next=c.previous=c;else{a=null,e=i;do{if(e.expirationTime>=t){a=e;break}e=e.next}while(e!==i);null===a?a=i:a===i&&(i=c,l()),(t=a.previous).next=a.previous=c,c.next=a,c.previous=t}}function d(){if(-1===n&&null!==i&&1===i.priorityLevel){s=!0;try{do{u()}while(null!==i&&1===i.priorityLevel)}finally{s=!1,null!==i?l():c=!1}}}function m(e){s=!0;var r=a;a=e;try{if(e)for(;null!==i;){var n=t.unstable_now();if(!(i.expirationTime<=n))break;do{u()}while(null!==i&&i.expirationTime<=n)}else if(null!==i)do{u()}while(null!==i&&!N())}finally{s=!1,a=r,null!==i?l():c=!1,d()}}var p,h,f=Date,v="function"==typeof setTimeout?setTimeout:void 0,b="function"==typeof clearTimeout?clearTimeout:void 0,g="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,y="function"==typeof cancelAnimationFrame?cancelAnimationFrame:void 0;function E(e){p=g(function(t){b(h),e(t)}),h=v(function(){y(p),e(t.unstable_now())},100)}if("object"==typeof performance&&"function"==typeof performance.now){var S=performance;t.unstable_now=function(){return S.now()}}else t.unstable_now=function(){return f.now()};var w,_,N,M=null;if("undefined"!=typeof window?M=window:void 0!==e&&(M=e),M&&M._schedMock){var O=M._schedMock;w=O[0],_=O[1],N=O[2],t.unstable_now=O[3]}else if("undefined"==typeof window||"function"!=typeof MessageChannel){var D=null,k=function(e){if(null!==D)try{D(e)}finally{D=null}};w=function(e){null!==D?setTimeout(w,0,e):(D=e,setTimeout(k,0,!1))},_=function(){D=null},N=function(){return!1}}else{"undefined"!=typeof console&&("function"!=typeof g&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof y&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var C=null,I=!1,x=-1,T=!1,j=!1,L=0,A=33,R=33;N=function(){return L<=t.unstable_now()};var P=new MessageChannel,V=P.port2;P.port1.onmessage=function(){I=!1;var e=C,i=x;C=null,x=-1;var a=t.unstable_now(),r=!1;if(0>=L-a){if(!(-1!==i&&i<=a))return T||(T=!0,E(U)),C=e,void(x=i);r=!0}if(null!==e){j=!0;try{e(r)}finally{j=!1}}};var U=function(e){if(null!==C){E(U);var t=e-L+R;t<R&&A<R?(8>t&&(t=8),R=t<A?A:t):A=t,L=e+R,I||(I=!0,V.postMessage(void 0))}else T=!1};w=function(e,t){C=e,x=t,j||0>t?V.postMessage(void 0):T||(T=!0,E(U))},_=function(){C=null,I=!1,x=-1}}t.unstable_ImmediatePriority=1,t.unstable_UserBlockingPriority=2,t.unstable_NormalPriority=3,t.unstable_IdlePriority=5,t.unstable_LowPriority=4,t.unstable_runWithPriority=function(e,i){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=r,o=n;r=e,n=t.unstable_now();try{return i()}finally{r=a,n=o,d()}},t.unstable_next=function(e){switch(r){case 1:case 2:case 3:var i=3;break;default:i=r}var a=r,o=n;r=i,n=t.unstable_now();try{return e()}finally{r=a,n=o,d()}},t.unstable_scheduleCallback=function(e,a){var o=-1!==n?n:t.unstable_now();if("object"==typeof a&&null!==a&&"number"==typeof a.timeout)a=o+a.timeout;else switch(r){case 1:a=o+-1;break;case 2:a=o+250;break;case 5:a=o+1073741823;break;case 4:a=o+1e4;break;default:a=o+5e3}if(e={callback:e,priorityLevel:r,expirationTime:a,next:null,previous:null},null===i)i=e.next=e.previous=e,l();else{o=null;var s=i;do{if(s.expirationTime>a){o=s;break}s=s.next}while(s!==i);null===o?o=i:o===i&&(i=e,l()),(a=o.previous).next=o.previous=e,e.next=o,e.previous=a}return e},t.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(t===e)i=null;else{e===i&&(i=t);var a=e.previous;a.next=t,t.previous=a}e.next=e.previous=null}},t.unstable_wrapCallback=function(e){var i=r;return function(){var a=r,o=n;r=i,n=t.unstable_now();try{return e.apply(this,arguments)}finally{r=a,n=o,d()}}},t.unstable_getCurrentPriorityLevel=function(){return r},t.unstable_shouldYield=function(){return!a&&(null!==i&&i.expirationTime<o||N())},t.unstable_continueExecution=function(){null!==i&&l()},t.unstable_pauseExecution=function(){},t.unstable_getFirstCallbackNode=function(){return i}}).call(this,i(12))},function(e,t,i){"use strict";var a=i(18);e.exports=function(e,t,i){i=i||{};var r={fftSize:1024,bufferLen:1024,smoothingTimeConstant:.2,minCaptureFreq:85,maxCaptureFreq:255,noiseCaptureDuration:1e3,minNoiseLevel:.3,maxNoiseLevel:.7,avgNoiseMultiplier:1.2,onVoiceStart:function(){},onVoiceStop:function(){},onUpdate:function(e){}},n={};for(var o in r)n[o]=i.hasOwnProperty(o)?i[o]:r[o];var s=0,c=1,l=0,u=0,d=60,m=5,p=[],h=!0,f=void 0,v=!1,b=null,g=e.createMediaStreamSource(t),y=e.createAnalyser();y.smoothingTimeConstant=n.smoothingTimeConstant,y.fftSize=n.fftSize;var E=e.createScriptProcessor(n.bufferLen,1,1);function S(){g.connect(y),y.connect(E),E.connect(e.destination)}function w(){E.disconnect(),y.disconnect(),g.disconnect()}return S(),E.onaudioprocess=function(){var e=new Uint8Array(y.frequencyBinCount);y.getByteFrequencyData(e);var t=a(y,e,n.minCaptureFreq,n.maxCaptureFreq);if(h)return void p.push(t);t>=s&&l<d?l++:t<s&&l>u&&l--;f!==(v=l>m)&&(v?n.onVoiceStart():n.onVoiceStop(),f=v);n.onUpdate(Math.max(0,t-s)/c)},h&&(b=setTimeout(function(){h=!1;var e=(p=p.filter(function(e){return e}).sort()).length?p.reduce(function(e,t){return Math.min(e,t)},1):n.minNoiseLevel||.1;s=e*n.avgNoiseMultiplier,n.minNoiseLevel&&s<n.minNoiseLevel&&(s=n.minNoiseLevel);n.maxNoiseLevel&&s>n.maxNoiseLevel&&(s=n.maxNoiseLevel);c=1-s},n.noiseCaptureDuration)),{connect:S,disconnect:w,destroy:function(){b&&clearTimeout(b),w(),E.onaudioprocess=null}}}},function(e,t,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,o,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in i=Object(arguments[c]))r.call(i,l)&&(s[l]=i[l]);if(a){o=a(i);for(var u=0;u<o.length;u++)n.call(i,o[u])&&(s[o[u]]=i[o[u]])}}return s}},function(e,t,i){"use strict";e.exports=i(13)},function(e,t){var i,a,r=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:n}catch(e){i=n}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,l=[],u=!1,d=-1;function m(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&p())}function p(){if(!u){var e=s(m);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new h(e,t)),1!==l.length||u||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){var a=i(19);function r(e,t,i,r,n){for(var o=t.context.sampleRate,s=t.frequencyBinCount,c=a(r,o,s),l=a(n,o,s),u=l-c,d=0;c<l;c++)d+=i[c]/e;return 0===u?0:d/u}e.exports=r.bind(null,255),e.exports.floatData=r.bind(null,1)},function(e,t,i){var a=i(20);e.exports=function(e,t,i){var r=t/2,n=Math.round(e/r*i);return a(n,0,i)}},function(e,t){e.exports=function(e,t,i){return t<i?e<t?t:e>i?i:e:e<i?i:e>t?t:e}},,,,,function(e,t,i){"use strict";i.r(t);var a=i(0),r=i.n(a),n=i(7),o=i.n(n),s=i(2),c=i(1),l=i(8);class u{constructor(){this.roomType="",this.roomName="",this.isAppReady=!1,this.isWelcomeOpen=!0,this.isSettingOpen=!0,this.isChatOpen=!1,this.isRoomJoin=!1,this.isUserError=!1,this.isAppError=!1}get confUrl(){const e=`#!/${this.roomType}/${this.roomName}`;return`${location.origin}${location.pathname}${e}`}get isError(){return this.isUserError||this.isAppError}setRoom({roomType:e,roomName:t}){l.a.isValidRoomName(t)&&l.a.isValidRoomType(e)?(this.roomType=e,this.roomName=t):this.isUserError=!0}handleGetUserMediaError(e){switch(e.name){case"OverconstrainedError":case"NotFoundError":this.isAppError=!0;break;default:this.isUserError=!0}console.error(e)}handleAppError(e){this.isAppError=!0,console.error(e)}handleUserError(e){this.isUserError=!0,console.error(e)}}Object(c.h)(u,{roomType:c.m,roomName:c.m,isAppReady:c.m,isWelcomeOpen:c.m,isSettingOpen:c.m,isChatOpen:c.m,isRoomJoin:c.m,isUserError:c.m,isAppError:c.m,confUrl:c.e,isError:c.e});var d=u;class m{constructor(){this.peerId="YOUR_PEER_ID",this.dispName="YOUR_NAME",this.isVideoMuted=!1,this.isAudioMuted=!1,this.isSpeaking=!1,this.videoDeviceId="",this.audioDeviceId="",this.videoDevices=[],this.audioDevices=[]}get facingMode(){return 2!==this.videoDevices.length?"environment":this.videoDeviceId===this.videoDevices[1].deviceId?"user":"environment"}get syncState(){return{peerId:this.peerId,dispName:this.dispName,isVideoMuted:this.isVideoMuted,isAudioMuted:this.isAudioMuted,isSpeaking:this.isSpeaking}}get isNoVideoDevices(){return 0===this.videoDevices.length}get isNoAudioDevices(){return 0===this.audioDevices.length}updateDevices({video:e,audio:t}){this.videoDevices=e,this.audioDevices=t,this._setDefaultDeviceIfNeeded()}_setDefaultDeviceIfNeeded(){const e=this.videoDevices.find(e=>e.deviceId===this.videoDeviceId),t=this.audioDevices.find(e=>e.deviceId===this.audioDeviceId);!1===this.isNoVideoDevices&&(e||(this.videoDeviceId=this.videoDevices[0].deviceId)),!1===this.isNoAudioDevices&&(t||(this.audioDeviceId=this.audioDevices[0].deviceId))}}Object(c.h)(m,{peerId:c.m,dispName:c.m,isVideoMuted:c.m,isAudioMuted:c.m,isSpeaking:c.m,videoDeviceId:c.m,audioDeviceId:c.m,videoDevices:c.m.ref,audioDevices:c.m.ref,syncState:c.e,facingMode:c.e,isNoVideoDevices:c.e,isNoAudioDevices:c.e,updateDevices:c.d,_setDefaultDeviceIfNeeded:c.d});var p=m;class h{constructor(){this.syncState=new Map,this.pinnedPeerId="",this.localStream={},this.remoteStreams=[]}get pinnedPeerIdDisp(){return 0!==this.pinnedPeerId.length?this.pinnedPeerId:0!==this.remoteStreams.length?this.remoteStreams[0].peerId:""}get pinnedStream(){const e=this.remoteStreams.find(e=>e.peerId===this.pinnedPeerIdDisp);return e||(0!==this.remoteStreams.length?this.remoteStreams[0]:null)}setLocalStream(e){this.localStream=e}addRemoteStream(e){const t=this.remoteStreams.find(t=>t.peerId===e.peerId);this.removeRemoteStream(t),this.remoteStreams.push(e)}removeRemoteStreamByPeerId(e){const t=this.remoteStreams.find(t=>t.peerId===e);this.removeRemoteStream(t),this.syncState.delete(e),this.pinnedPeerId===e&&(this.pinnedPeerId="")}removeRemoteStream(e){e&&this.remoteStreams.remove(e)}}Object(c.h)(h,{syncState:c.m,pinnedPeerId:c.m,localStream:c.m.ref,remoteStreams:c.m.shallow,pinnedPeerIdDisp:c.e,pinnedStream:c.e,setLocalStream:c.d,addRemoteStream:c.d,removeRemoteStreamByPeerId:c.d,removeRemoteStream:c.d});var f=h;class v{constructor(){this.bufferText="",this.lastMessage={},this.messages=[]}addMessage({text:e,timestamp:t,peerId:i},a,r){this.messages.push({id:`${i}-${t}`,text:e,dispDate:new Date(t).toLocaleTimeString().slice(0,5),thumb:a,dispName:r})}updateBuffer(e){this.lastMessage=e,this.bufferText=""}}Object(c.h)(v,{bufferText:c.m,lastMessage:c.m.ref,messages:c.m.shallow,updateBuffer:c.d});var b=v;class g{constructor(){this.items=[]}showChat(e){this._show(`${e.dispName} sent a chat`)}showJoin(e){this._show(`${e.dispName} joined`)}showLeave(e){this._show(`${e.dispName} left`)}_show(e){const t={id:Date.now(),text:e};this.items.push(t),setTimeout(()=>this.items.remove(t),1e3)}}Object(c.h)(g,{items:c.m.shallow});var y=g;var E=class{constructor(){this.ui=new d,this.user=new p,this.room=new f,this.chat=new b,this.notification=new y}},S=i(14),w=i.n(S),_=i(10),N=i(3),M=i(11),O=i(4);var D=class extends _.a{constructor(e){super(e),this._destroyVad=null;const{user:t,room:i,ui:a}=this.store;Object(c.n)(()=>[t.videoDeviceId,t.audioDeviceId],async([e,r])=>{const n=await N.a.getUserMedia({videoDeviceId:e,audioDeviceId:r},t.facingMode).catch(e=>a.handleGetUserMediaError(e));a.isError||(i.localStream instanceof MediaStream&&N.a.stopStream(i.localStream),a.isAppReady=!0,t.isVideoMuted&&N.a.setMuteVideoTracks(n,!0),t.isAudioMuted&&N.a.setMuteAudioTracks(n,!0),i.setLocalStream(n))}),Object(c.n)(()=>t.isVideoMuted,e=>N.a.setMuteVideoTracks(i.localStream,e)),Object(c.n)(()=>t.isAudioMuted,e=>N.a.setMuteAudioTracks(i.localStream,e)),Object(c.n)(()=>t.dispName,e=>localStorage.setItem("SkyWayConf.dispName",e)),Object(c.q)(()=>a.isAppReady,async()=>{const e=await N.a.getUserDevices().catch(e=>a.handleUserError(e));a.isError||t.updateDevices(e)})}onClickWelcomeClose(){const{ui:e,user:t,room:i}=this.store;e.isWelcomeOpen=!1,Object(c.n)(()=>i.localStream,e=>{this._destroyVad&&this._destroyVad();const{destroy:i}=w()(O.a.getAudioCtx(window),e,{onUpdate(e){t.isSpeaking=0!==e}});this._destroyVad=i},{fireImmediately:!0})}async onLoad({roomType:e,roomName:t}){const{user:i,ui:a,room:r}=this.store;a.setRoom({roomType:e,roomName:t});const n=localStorage.getItem("SkyWayConf.dispName");n&&(i.dispName=n);const o=await N.a.getUserPermission(),s=await N.a.getUserDevices().catch(e=>a.handleUserError(e));if(!a.isError){if(i.updateDevices(s),i.isNoVideoDevices&&i.isNoAudioDevices){a.isAppReady=!0;const e=N.a.getFakeStream(O.a.getAudioCtx(window));r.setLocalStream(e)}N.a.stopStream(o),navigator.mediaDevices.ondevicechange=async function(){const e=await N.a.getUserDevices().catch(e=>a.handleUserError(e));a.isError||i.updateDevices(e)}}}async onClickJoinRoom(){const{ui:e,room:t,user:i}=this.store,a=await M.a.initPeer().catch(t=>e.handleAppError(t));if(e.isError)return;a.on("error",t=>e.handleSkyWayPeerError(t)),i.peerId=a.id;const r=a.joinRoom(`${e.roomType}/${e.roomName}`,{mode:e.roomType,stream:t.localStream});this._onRoomJoin(r),e.isSettingOpen=!1}async onClickSendChat(){const{chat:e,user:t,room:i,ui:a}=this.store,r=await N.a.snapVideoStream(i.localStream,"image/jpeg",.5).catch(e=>a.handleAppError(e));if(a.isError)return;const n={peerId:t.peerId,text:e.bufferText,blob:r,timestamp:Date.now()},o=URL.createObjectURL(r);e.addMessage(n,o,t.dispName),e.updateBuffer(n)}_onRoomJoin(e){const{ui:t,user:i,room:a,chat:r}=this.store;t.isRoomJoin=!0,e.on("stream",t=>this._onRoomAddStream(t,e)),e.on("peerLeave",e=>this._onRoomPeerLeave(e)),e.on("data",e=>this._onRoomData(e)),Object(c.n)(()=>a.localStream,()=>e.replaceStream(a.localStream)),Object(c.n)(()=>i.syncState,t=>e.send({type:"sync",payload:t})),Object(c.n)(()=>r.lastMessage,t=>e.send({type:"chat",payload:t}))}_onRoomAddStream(e,t){const{room:i,user:a,notification:r}=this.store;i.addRemoteStream(e),t.send({type:"sync",payload:a.syncState}),Object(c.q)(()=>void 0!==i.syncState.get(e.peerId),()=>r.showJoin(i.syncState.get(e.peerId)))}_onRoomPeerLeave(e){const{room:t,notification:i}=this.store,a=t.syncState.get(e);i.showLeave(a),t.removeRemoteStreamByPeerId(e)}_onRoomData({_src:e,data:t}){const{room:i,chat:a,ui:r,notification:n}=this.store,{type:o,payload:s}=t;switch(o){case"sync":i.syncState.set(s.peerId,s);break;case"chat":{const e=i.syncState.get(s.peerId),t=new Blob([new Uint8Array(s.blob)]),o=URL.createObjectURL(t);a.addMessage(s,o,e.dispName),r.isChatOpen||n.showChat(e);break}default:throw new Error(`${o} is not defined as message type`)}}};var k=()=>r.a.createElement("div",{className:"Loader"},r.a.createElement("img",{className:"Loader_Image",src:"./images/conf/icon-loading.svg",alt:"Loading"}));var C=Object(s.c)(({ui:e})=>r.a.createElement("div",{className:"Error"},r.a.createElement("div",{className:"Error_Title"},r.a.createElement("i",{className:"material-icons"},"error"),r.a.createElement("span",null,"Error")),e.isUserError&&r.a.createElement("div",{className:"Error_Desc"},r.a.createElement("p",null,"Please check your.."),r.a.createElement("ul",null,r.a.createElement("li",null,"current url(and hash)"),r.a.createElement("li",null,"camera or microphone settings"),r.a.createElement("li",null,"network conditions"),r.a.createElement("li",null,"browser updates"))),e.isAppError&&r.a.createElement("div",{className:"Error_Desc"},r.a.createElement("p",null,"Sorry, currently our service is not available. Please try it later."))));var I=Object(s.b)("ui","action")(Object(s.c)(class extends r.a.Component{render(){const{ui:e,children:t}=this.props;return e.isError?r.a.createElement(C,{ui:e}):e.isAppReady?t:r.a.createElement(k,null)}componentDidCatch(e){this.props.action.$update("ui.isAppError",!0),console.error(e)}}));var x=Object(s.c)(class extends r.a.Component{constructor(){super(),this._vRef=null,this._aRef=null}render(){const{muted:e,isMirror:t,stream:i}=this.props;return r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{className:`Video ${t?"-reverse":""}`,ref:e=>{this._vRef=e},muted:!0,autoPlay:!0,playsInline:!0}),r.a.createElement("audio",{ref:e=>{this._aRef=e},muted:e,autoPlay:!0}))}componentDidMount(){this._vRef&&this._aRef&&this.props.stream instanceof MediaStream&&(this._vRef.srcObject=this._aRef.srcObject=this.props.stream)}componentWillReact(){this._vRef&&this._aRef&&this.props.stream instanceof MediaStream&&(this._vRef.srcObject=this._aRef.srcObject=this.props.stream)}});var T=Object(s.c)(({room:e})=>r.a.createElement("div",{className:"ScreenVideo"},e.pinnedStream?r.a.createElement(x,{stream:e.pinnedStream,muted:!0}):null));var j=Object(s.b)("room")(Object(s.c)(({room:e})=>r.a.createElement(T,{room:e})));var L=class extends r.a.Component{constructor(){super(),this._ref=null,this._disposer=null,this._checkListWidth=this._checkListWidth.bind(this)}render(){return r.a.createElement("div",{className:"MemberList"},r.a.createElement("div",{className:"MemberList_Arrow -left"},r.a.createElement("i",{className:"material-icons"},"chevron_left")),r.a.createElement("div",{ref:e=>this._ref=e,className:"MemberList_Scroller"},this.props.children),r.a.createElement("div",{className:"MemberList_Arrow -right"},r.a.createElement("i",{className:"material-icons"},"chevron_right")))}componentDidMount(){const{room:e}=this.props;this._disposer=Object(c.n)(()=>e.remoteStreams.length,()=>this._checkListWidth(),{fireImmediately:!0,delay:500}),window.addEventListener("resize",this._checkListWidth)}componentWillUnmount(){this._disposer(),window.removeEventListener("resize",this._checkListWidth)}_checkListWidth(){parseInt(getComputedStyle(this._ref).width)<Array.from(this._ref.children).reduce((e,t)=>e+parseInt(getComputedStyle(t).width),0)?this._ref.parentElement.classList.add("-scrollable"):this._ref.parentElement.classList.remove("-scrollable")}},A=i(5),R=i(6);var P=Object(s.c)(({user:e,action:t})=>r.a.createElement("div",{className:"MemberVideo"},r.a.createElement("div",{className:"MemberVideo_Local"},r.a.createElement("button",{onClick:()=>t.$update("user.isVideoMuted",!e.isVideoMuted),title:e.isVideoMuted?"Unmute":"Mute"},r.a.createElement(A.a,{isMuted:e.isVideoMuted,isSelf:!0})),r.a.createElement("button",{onClick:()=>t.$update("user.isAudioMuted",!e.isAudioMuted),title:e.isAudioMuted?"Unmute":"Mute"},r.a.createElement(R.a,{isMuted:e.isAudioMuted,isSelf:!0})),r.a.createElement("button",{onClick:()=>t.$update("ui.isSettingOpen",!0),title:"Open settings"},r.a.createElement("i",{className:"material-icons"},"settings")),r.a.createElement("button",{onClick:()=>t.$update("ui.isChatOpen",!0),title:"Open chat"},r.a.createElement("i",{className:"material-icons"},"chat"))))),V=i(9);var U=Object(s.c)(({room:e,action:t})=>r.a.createElement(r.a.Fragment,null,e.remoteStreams.map(i=>{const a=e.syncState.get(i.peerId);return r.a.createElement("div",{key:i.id,className:"MemberVideo",onClick:()=>t.$update("room.pinnedPeerId",i.peerId)},e.pinnedPeerIdDisp===i.peerId&&r.a.createElement("div",{className:"MemberVideo_Pinned"}),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"MemberVideo_Name"},a.dispName),r.a.createElement("div",{className:"MemberVideo_Media"},a.isVideoMuted&&r.a.createElement(A.a,{isMuted:!0}),a.isAudioMuted&&r.a.createElement(R.a,{isMuted:!0}),a.isSpeaking&&r.a.createElement(V.a,{isSpeaking:!0}))):null,r.a.createElement(x,{stream:i}))})));var $=Object(s.b)("room","user","action")(Object(s.c)(({room:e,user:t,action:i})=>r.a.createElement(L,{room:e},r.a.createElement(P,{user:t,action:i}),r.a.createElement(U,{room:e,action:i}))));const W=({isVisible:e,children:t})=>r.a.createElement("div",{className:"Popup",style:{transform:e?"translate3d(0, 0, 0)":"translate3d(0, -100%, 0)",visibility:e?"visible":"hidden"}},t),F=({isVisible:e,children:t})=>e?r.a.createElement("div",{className:"Popup"},t):null;var B=Object(s.c)(({isVisible:e,noAnim:t=!1,children:i})=>t?r.a.createElement(F,{isVisible:e},i):r.a.createElement(W,{isVisible:e},i));var q=Object(s.c)(({ui:e,room:t})=>r.a.createElement(x,{stream:t.localStream,muted:!0,isMirror:!1===e.isScreenSharing}));var J=Object(s.c)(({user:e,action:t})=>r.a.createElement("div",{className:"DeviceSelector"},r.a.createElement("div",{className:"DeviceSelector_Label"},"Cam / Mic"),r.a.createElement("div",{className:"DeviceSelector_Row"},r.a.createElement("select",{className:"DeviceSelector_Select",value:e.videoDeviceId,onChange:e=>t.$update("user.videoDeviceId",e.target.value),disabled:e.isNoVideoDevices},e.isNoVideoDevices&&r.a.createElement("option",{value:""},"Cam not found"),e.videoDevices.map((e,t)=>r.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||`Cam ${t+1}`))),r.a.createElement("button",{onClick:()=>t.$update("user.isVideoMuted",!e.isVideoMuted),title:e.isVideoMuted?"Unmute":"Mute"},r.a.createElement(A.a,{isMuted:e.isVideoMuted,isSelf:!0}))),r.a.createElement("div",{className:"DeviceSelector_Row"},r.a.createElement("select",{className:"DeviceSelector_Select",value:e.audioDeviceId,onChange:e=>t.$update("user.audioDeviceId",e.target.value),disabled:e.isNoAudioDevices},e.isNoAudioDevices&&r.a.createElement("option",{value:""},"Mic not found"),e.audioDevices.map((e,t)=>r.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||`Mic ${t+1}`))),r.a.createElement("button",{onClick:()=>t.$update("user.isAudioMuted",!e.isAudioMuted),title:e.isAudioMuted?"Unmute":"Mute"},r.a.createElement(R.a,{isMuted:e.isAudioMuted,isSelf:!0})),r.a.createElement("span",{className:"DeviceSelector_Va"},r.a.createElement(V.a,{isSpeaking:e.isSpeaking})))));var z=Object(s.c)(({user:e,action:t})=>r.a.createElement("div",{className:"NameEdit"},r.a.createElement("div",{className:"NameEdit_Label"},"Name"),r.a.createElement("input",{className:"NameEdit_Input",type:"text",maxLength:10,value:e.dispName,onChange:e=>t.$update("user.dispName",e.target.value)})));var H=Object(s.b)("room","ui","user","action")(Object(s.c)(({room:e,ui:t,user:i,action:a})=>r.a.createElement(B,{isVisible:t.isSettingOpen},r.a.createElement("div",{className:"L-Setting"},r.a.createElement("div",{className:"L-Setting_Video"},r.a.createElement(q,{ui:t,room:e})),r.a.createElement(J,{user:i,action:a}),r.a.createElement(z,{user:i,action:a}),r.a.createElement("div",{className:"L-Setting_Finish"},r.a.createElement("button",{onClick:()=>{t.isRoomJoin?a.$update("ui.isSettingOpen",!1):a.onClickJoinRoom()}},t.isRoomJoin?"Close":"OK"))))));var G=Object(s.c)(class extends r.a.Component{constructor(){super(),this._ref=null}render(){const{chat:e}=this.props;return r.a.createElement("ul",{className:"ChatMessageList",ref:e=>this._ref=e},e.messages.map(e=>r.a.createElement("li",{key:e.id},r.a.createElement("div",{className:"ChatMessageList_Item"},r.a.createElement("div",{className:"ChatMessageList_Item_Thumb"},r.a.createElement("img",{className:"ChatMessageList_Item_Thumb_Image",src:e.thumb})),r.a.createElement("div",{className:"ChatMessageList_Item_Content"},r.a.createElement("div",{className:"ChatMessageList_Item_Content_Head"},r.a.createElement("span",{className:"ChatMessageList_Item_Content_HeadName"},e.dispName),r.a.createElement("span",{className:"ChatMessageList_Item_Content_HeadDate"},"at ",e.dispDate)),r.a.createElement("p",{className:"ChatMessageList_Item_Content_Body"},e.text))))))}componentWillReact(){this._ref&&requestAnimationFrame(()=>this._ref.scrollTop=this._ref.scrollHeight)}});var K=Object(s.c)(({chat:e,action:t})=>r.a.createElement("div",{className:"ChatBox"},r.a.createElement("button",{className:"ChatBox_Closer",onClick:()=>t.$update("ui.isChatOpen",!1)},r.a.createElement("i",{className:"material-icons -x05"},"close")),r.a.createElement(G,{chat:e}),r.a.createElement("div",{className:"ChatBox_Action"},r.a.createElement("input",{className:"ChatBox_Action_Input",type:"text",placeholder:"Type messages here...",value:e.bufferText,onChange:e=>t.$update("chat.bufferText",e.target.value)}),r.a.createElement("button",{disabled:0===e.bufferText.length,onClick:()=>t.onClickSendChat()},"Send"))));var Y=Object(s.b)("ui","chat","action")(Object(s.c)(({ui:e,chat:t,action:i})=>r.a.createElement(B,{isVisible:e.isChatOpen},r.a.createElement(K,{ui:e,chat:t,action:i}))));var X=Object(s.b)("ui","action")(Object(s.c)(({ui:e,action:t})=>r.a.createElement(B,{isVisible:e.isWelcomeOpen,noAnim:!0},r.a.createElement("div",{className:"L-Welcome"},r.a.createElement("h3",{className:"L-Welcome_Header"},"SkyWayConferenceMobile"),r.a.createElement("p",{className:"L-Welcome_Messages"},"This site plays sound.",r.a.createElement("br",null),"And this site uses your camera and microphone until closing tab."),r.a.createElement("div",{className:"L-Welcome_Finish"},r.a.createElement("button",{onClick:()=>t.onClickWelcomeClose()},"OK"))))));var Q=Object(s.c)(({notification:e})=>r.a.createElement(r.a.Fragment,null,e.items.map(e=>r.a.createElement("div",{className:"Toast",key:e.id},e.text))));var Z=Object(s.b)("notification")(Object(s.c)(({notification:e})=>r.a.createElement("div",{className:"L-Notification"},r.a.createElement(Q,{notification:e}))));var ee=()=>r.a.createElement(I,null,r.a.createElement("main",{className:"L-Main"},r.a.createElement(j,null),r.a.createElement($,null)),r.a.createElement(H,null),r.a.createElement(Y,null),r.a.createElement(X,null),r.a.createElement(Z,null));function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e}).apply(this,arguments)}!function(){const[,e,t]=location.hash.split("/"),i=O.a.getOsName(navigator.userAgent),a=O.a.getBrowserName(navigator.userAgent);if(!1===(["Windows","Mac","iOS","Android"].includes(i)&&["Chrome","Firefox","Safari"].includes(a)))return void(location.href="./not_supported.html");if(!1===["iOS","Android"].includes(i))return void(location.href=`./conf.html${location.hash}`);if(/iPod/.test(navigator.userAgent))return void(location.href="./not_supported.html");const n=new E,c=new D(n);c.onLoad({roomType:e,roomName:t}),o.a.render(r.a.createElement(s.a,te({action:c},n),r.a.createElement(ee,null)),document.getElementById("app-root")),window.addEventListener("hashchange",()=>location.reload(!0))}()}]);