!function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],d=0,m=[];d<s.length;d++)o=s[d],n[o]&&m.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);m.length;)m.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={2:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([30,0]),a()}([,,,function(e,t,a){"use strict";t.a={setMuteVideoTracks:function(e,t){e.getVideoTracks().forEach(e=>e.enabled=!t)},setMuteAudioTracks:function(e,t){e.getAudioTracks().forEach(e=>e.enabled=!t)},setMuteTrack:function(e,t){e.enabled=!t},stopStream:function(e){e.getTracks().forEach(e=>e.stop())},getUserDevices:async function(){const e={video:[],audio:[]},t=await navigator.mediaDevices.enumerateDevices();for(const a of t)"videoinput"===a.kind&&e.video.push(a),"audioinput"===a.kind&&e.audio.push(a);return e},getUserMedia:function({videoDeviceId:e,audioDeviceId:t},a){const r={video:{deviceId:e},audio:{deviceId:t}};return""===e&&(r.video=!1),""===t&&(r.audio=!1),["user","environment"].includes(a)&&(r.video.facingMode=a),navigator.mediaDevices.getUserMedia(r)},snapVideoStream:function(e,t="image/jpeg",a=1){return new Promise(r=>{let n=document.createElement("video");n.addEventListener("loadeddata",()=>{let e=document.createElement("canvas");e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0),e.toBlob(t=>{n.pause(),n.srcObject=null,n=e=null,r(t)},t,a)},{once:!0}),n.autoplay=n.muted=n.playsInline=!0,n.srcObject=e})},getFakeStream:function(e){const{stream:t}=e.createMediaStreamDestination();return t}}},function(e,t,a){"use strict";t.a={getOsName:function(e){switch(!0){case/Android/.test(e):return"Android";case/iPhone|iPad|iPod/.test(e):return"iOS";case/Windows/.test(e):return"Windows";case/Mac OS X/.test(e):return"Mac";case/CrOS/.test(e):return"CromeOS";case/Firefox/.test(e):return"FirefoxOS";default:return""}},getBrowserName:function(e){switch(!0){case/CriOS/.test(e):return"iOSChrome";case/Edge/.test(e):return"Edge";case/Chrome/.test(e):return"Chrome";case/Firefox/.test(e):return"Firefox";case/MSIE|Trident/.test(e):return"IE";case/Safari\//.test(e):return"Safari";case/AppleWebKit/.test(e):return"Webkit";default:return""}},getAudioCtx:function(e){return new(e.webkitAudioContext||e.AudioContext)},setLocationHref:function(e){location.href=e}}},function(e,t,a){"use strict";var r=a(0),n=a.n(r);t.a=(({isMuted:e=!1})=>e?n.a.createElement("i",{className:"material-icons"},"mic_off"):n.a.createElement("i",{className:"material-icons"},"mic"))},function(e,t,a){"use strict";var r=a(0),n=a.n(r);t.a=(({isMuted:e=!1})=>e?n.a.createElement("i",{className:"material-icons"},"videocam_off"):n.a.createElement("i",{className:"material-icons"},"videocam"))},,function(e,t,a){"use strict";t.a={isValidRoomType:function(e){return"sfu"===e||"mesh"===e},isValidRoomName:function(e){return/^[0-9a-z_-]{4,32}$/.test(e)}}},function(e,t,a){"use strict";var r=a(0),n=a.n(r);t.a=(({isSpeaking:e=!1})=>n.a.createElement("i",{className:`material-icons ${e?"-speaking":"-not_speaking"}`},"equalizer"))},function(e,t,a){"use strict";t.a=class{constructor(e){this.store=e}$update(e,t){const[a,r]=e.split(".");if(!(a&&r&&a in this.store&&r in this.store[a]))throw new Error(`${a}.${r} is not defined!`);this.store[a][r]=t}}},function(e,t,a){"use strict";const r=window.Peer,n=window.ScreenShare;t.a={initPeer:function(){return new Promise((e,t)=>{const a=new r({key:"03ff6219-b58f-4310-9484-e9108e859cdd",debug:2});a.once("open",()=>{e(a),a.removeListener("error",t)}),a.once("error",t)})},isScreenShareAvailable:function(){return n.create().isScreenShareAvailable()},getScreenStreamTrack:function(){return new Promise((e,t)=>{n.create().start().then(t=>e(t.getTracks()[0])).catch(t)})}}},function(e,t,a){"use strict";e.exports=function(e){var t=(e?e.ownerDocument||e:document).defaultView||window;return!(!e||!("function"==typeof t.Node?e instanceof t.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}},function(e,t,a){"use strict";var r=a(12);e.exports=function(e){return r(e)&&3==e.nodeType}},function(e,t,a){"use strict";var r=a(20);e.exports=function(e,t,a){a=a||{};var n={fftSize:1024,bufferLen:1024,smoothingTimeConstant:.2,minCaptureFreq:85,maxCaptureFreq:255,noiseCaptureDuration:1e3,minNoiseLevel:.3,maxNoiseLevel:.7,avgNoiseMultiplier:1.2,onVoiceStart:function(){},onVoiceStop:function(){},onUpdate:function(e){}},i={};for(var o in n)i[o]=a.hasOwnProperty(o)?a[o]:n[o];var s=0,c=1,l=0,u=0,d=60,m=5,h=[],p=!0,f=void 0,v=!1,S=null,g=e.createMediaStreamSource(t),E=e.createAnalyser();E.smoothingTimeConstant=i.smoothingTimeConstant,E.fftSize=i.fftSize;var b=e.createScriptProcessor(i.bufferLen,1,1);function y(){g.connect(E),E.connect(b),b.connect(e.destination)}function k(){b.disconnect(),E.disconnect(),g.disconnect()}return y(),b.onaudioprocess=function(){var e=new Uint8Array(E.frequencyBinCount);E.getByteFrequencyData(e);var t=r(E,e,i.minCaptureFreq,i.maxCaptureFreq);if(p)return void h.push(t);t>=s&&l<d?l++:t<s&&l>u&&l--;f!==(v=l>m)&&(v?i.onVoiceStart():i.onVoiceStop(),f=v);i.onUpdate(Math.max(0,t-s)/c)},p&&(S=setTimeout(function(){p=!1;var e=(h=h.filter(function(e){return e}).sort()).length?h.reduce(function(e,t){return Math.min(e,t)},1):i.minNoiseLevel||.1;s=e*i.avgNoiseMultiplier,i.minNoiseLevel&&s<i.minNoiseLevel&&(s=i.minNoiseLevel);i.maxNoiseLevel&&s>i.maxNoiseLevel&&(s=i.maxNoiseLevel);c=1-s},i.noiseCaptureDuration)),{connect:y,disconnect:k,destroy:function(){S&&clearTimeout(S),k(),b.onaudioprocess=null}}}},function(e,t,a){"use strict";function r(e){return function(){return e}}var n=function(){};n.thatReturns=r,n.thatReturnsFalse=r(!1),n.thatReturnsTrue=r(!0),n.thatReturnsNull=r(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,a){"use strict";e.exports={}},function(e,t,a){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},a=0;a<10;a++)t["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var a,o,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in a=Object(arguments[c]))n.call(a,l)&&(s[l]=a[l]);if(r){o=r(a);for(var u=0;u<o.length;u++)i.call(a,o[u])&&(s[o[u]]=a[o[u]])}}return s}},function(e,t){e.exports=function(e,t,a){return t<a?e<t?t:e>a?a:e:e<a?a:e>t?t:e}},function(e,t,a){var r=a(18);e.exports=function(e,t,a){var n=t/2,i=Math.round(e/n*a);return r(i,0,a)}},function(e,t,a){var r=a(19);function n(e,t,a,n,i){for(var o=t.context.sampleRate,s=t.frequencyBinCount,c=r(n,o,s),l=r(i,o,s),u=l-c,d=0;c<l;c++)d+=a[c]/e;return 0===u?0:d/u}e.exports=n.bind(null,255),e.exports.floatData=n.bind(null,1)},function(e,t){var a;a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t){var a,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(a===setTimeout)return setTimeout(e,0);if((a===i||!a)&&setTimeout)return a=setTimeout,setTimeout(e,0);try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:i}catch(e){a=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,l=[],u=!1,d=-1;function m(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&h())}function h(){if(!u){var e=s(m);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];l.push(new p(e,t)),1!==l.length||u||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,a){"use strict";var r=a(13);e.exports=function e(t,a){return!(!t||!a)&&(t===a||!r(t)&&(r(a)?e(t,a.parentNode):"contains"in t?t.contains(a):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(a))))}},function(e,t,a){"use strict";var r=Object.prototype.hasOwnProperty;function n(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}e.exports=function(e,t){if(n(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(var o=0;o<a.length;o++)if(!r.call(t,a[o])||!n(e[a[o]],t[a[o]]))return!1;return!0}},function(e,t,a){"use strict";e.exports=function(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}},function(e,t,a){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),n={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};e.exports=n},function(e,t,a){var r;!function(n,i,o){if(n){for(var s,c={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},u={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},d={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},m=1;m<20;++m)c[111+m]="f"+m;for(m=0;m<=9;++m)c[m+96]=m.toString();g.prototype.bind=function(e,t,a){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,a),this},g.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},g.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},g.prototype.reset=function(){return this._callbacks={},this._directMap={},this},g.prototype.stopCallback=function(e,t){return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!function e(t,a){return null!==t&&t!==i&&(t===a||e(t.parentNode,a))}(t,this.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},g.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},g.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(c[t]=e[t]);s=null},g.init=function(){var e=g(i);for(var t in e)"_"!==t.charAt(0)&&(g[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},g.init(),n.Mousetrap=g,void 0!==e&&e.exports&&(e.exports=g),void 0===(r=function(){return g}.call(t,a,t,e))||(e.exports=r)}function h(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent("on"+t,a)}function p(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return c[e.which]?c[e.which]:l[e.which]?l[e.which]:String.fromCharCode(e.which).toLowerCase()}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function v(e,t,a){return a||(a=function(){if(!s)for(var e in s={},c)e>95&&e<112||c.hasOwnProperty(e)&&(s[c[e]]=e);return s}()[e]?"keydown":"keypress"),"keypress"==a&&t.length&&(a="keydown"),a}function S(e,t){var a,r,n,i=[];for(a=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),n=0;n<a.length;++n)r=a[n],d[r]&&(r=d[r]),t&&"keypress"!=t&&u[r]&&(r=u[r],i.push("shift")),f(r)&&i.push(r);return{key:r,modifiers:i,action:t=v(r,i,t)}}function g(e){var t=this;if(e=e||i,!(t instanceof g))return new g(e);t.target=e,t._callbacks={},t._directMap={};var a,r={},n=!1,o=!1,s=!1;function c(e){e=e||{};var t,a=!1;for(t in r)e[t]?a=!0:r[t]=0;a||(s=!1)}function l(e,a,n,i,o,s){var c,l,u,d,m=[],h=n.type;if(!t._callbacks[e])return[];for("keyup"==h&&f(e)&&(a=[e]),c=0;c<t._callbacks[e].length;++c)if(l=t._callbacks[e][c],(i||!l.seq||r[l.seq]==l.level)&&h==l.action&&("keypress"==h&&!n.metaKey&&!n.ctrlKey||(u=a,d=l.modifiers,u.sort().join(",")===d.sort().join(",")))){var p=!i&&l.combo==o,v=i&&l.seq==i&&l.level==s;(p||v)&&t._callbacks[e].splice(c,1),m.push(l)}return m}function u(e,a,r,n){t.stopCallback(a,a.target||a.srcElement,r,n)||!1===e(a,r)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(a),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(a))}function d(e){"number"!=typeof e.which&&(e.which=e.keyCode);var a=p(e);a&&("keyup"!=e.type||n!==a?t.handleKey(a,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):n=!1)}function m(e,t,i,o){function l(t){return function(){s=t,++r[e],clearTimeout(a),a=setTimeout(c,1e3)}}function d(t){u(i,t,e),"keyup"!==o&&(n=p(t)),setTimeout(c,10)}r[e]=0;for(var m=0;m<t.length;++m){var h=m+1===t.length?d:l(o||S(t[m+1]).action);v(t[m],h,o,e,m)}}function v(e,a,r,n,i){t._directMap[e+":"+r]=a;var o,s=(e=e.replace(/\s+/g," ")).split(" ");s.length>1?m(e,s,a,r):(o=S(e,r),t._callbacks[o.key]=t._callbacks[o.key]||[],l(o.key,o.modifiers,{type:o.action},n,e,i),t._callbacks[o.key][n?"unshift":"push"]({callback:a,modifiers:o.modifiers,action:o.action,seq:n,level:i,combo:e}))}t._handleKey=function(e,t,a){var r,n=l(e,t,a),i={},d=0,m=!1;for(r=0;r<n.length;++r)n[r].seq&&(d=Math.max(d,n[r].level));for(r=0;r<n.length;++r)if(n[r].seq){if(n[r].level!=d)continue;m=!0,i[n[r].seq]=1,u(n[r].callback,a,n[r].combo,n[r].seq)}else m||u(n[r].callback,a,n[r].combo);var h="keypress"==a.type&&o;a.type!=s||f(e)||h||c(i),o=m&&"keydown"==a.type},t._bindMultiple=function(e,t,a){for(var r=0;r<e.length;++r)v(e[r],t,a)},h(e,"keypress",d),h(e,"keydown",d),h(e,"keyup",d)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},,,function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(7),o=a.n(i),s=a(2),c=a(1),l=a(8);class u{constructor(){this.roomType="",this.roomName="",this.isAppReady=!1,this.isSettingOpen=!0,this.isInviteOpen=!1,this.isChatOpen=!1,this.isChatSending=!1,this.isRoomJoin=!1,this.isScreenSharing=!1,this.isScreenShareIntroOpen=!1,this.isUserError=!1,this.isAppError=!1}get confUrl(){const e=`#!/${this.roomType}/${this.roomName}`;return`${location.origin}${location.pathname}${e}`}get isError(){return this.isUserError||this.isAppError}setRoom({roomType:e,roomName:t}){l.a.isValidRoomName(t)&&l.a.isValidRoomType(e)?(this.roomType=e,this.roomName=t):this.isUserError=!0}handleGetUserMediaError(e){switch(e.name){case"OverconstrainedError":case"NotFoundError":this.isAppError=!0;break;default:this.isUserError=!0}console.error(e)}handleAppError(e){this.isAppError=!0,console.error(e)}handleUserError(e){this.isUserError=!0,console.error(e)}}Object(c.f)(u,{roomType:c.k,roomName:c.k,isAppReady:c.k,isSettingOpen:c.k,isInviteOpen:c.k,isChatOpen:c.k,isChatSending:c.k,isRoomJoin:c.k,isScreenSharing:c.k,isScreenShareIntroOpen:c.k,isUserError:c.k,isAppError:c.k,confUrl:c.c,isError:c.c});var d=u;class m{constructor(){this.peerId="YOUR_PEER_ID",this.dispName="YOUR_NAME",this.isVideoMuted=!1,this.isAudioMuted=!1,this.isSpeaking=!1,this.videoDeviceId="",this.audioDeviceId="",this.videoDevices=[],this.audioDevices=[]}get syncState(){return{peerId:this.peerId,dispName:this.dispName,isVideoMuted:this.isVideoMuted,isAudioMuted:this.isAudioMuted,isSpeaking:this.isSpeaking}}get isNoVideoDevices(){return 0===this.videoDevices.length}get isNoAudioDevices(){return 0===this.audioDevices.length}updateDevices({video:e,audio:t}){Object(c.m)(()=>{this.videoDevices=e,this.audioDevices=t,this._setDefaultDeviceIfNeeded()})}_setDefaultDeviceIfNeeded(){const e=this.videoDevices.find(e=>e.deviceId===this.videoDeviceId),t=this.audioDevices.find(e=>e.deviceId===this.audioDeviceId);Object(c.m)(()=>{!1===this.isNoVideoDevices&&(e||(this.videoDeviceId=this.videoDevices[0].deviceId)),!1===this.isNoAudioDevices&&(t||(this.audioDeviceId=this.audioDevices[0].deviceId))})}}Object(c.f)(m,{peerId:c.k,dispName:c.k,isVideoMuted:c.k,isAudioMuted:c.k,isSpeaking:c.k,videoDeviceId:c.k,audioDeviceId:c.k,videoDevices:c.k.ref,audioDevices:c.k.ref,syncState:c.c,isNoVideoDevices:c.c,isNoAudioDevices:c.c});var h=m;class p{constructor(){this.syncState=new Map,this.pinnedPeerId="",this.localVideoStreamTrack={},this.localScreenStreamTrack={},this.localAudioStreamTrack={},this.remoteStreams=[]}get localStream(){const e=new MediaStream;return this.localAudioStreamTrack instanceof MediaStreamTrack&&e.addTrack(this.localAudioStreamTrack),this.localScreenStreamTrack instanceof MediaStreamTrack?e.addTrack(this.localScreenStreamTrack):this.localVideoStreamTrack instanceof MediaStreamTrack&&e.addTrack(this.localVideoStreamTrack),e}get pinnedPeerIdDisp(){return 0!==this.pinnedPeerId.length?this.pinnedPeerId:0!==this.remoteStreams.length?this.remoteStreams[0].peerId:""}get pinnedStream(){const e=this.remoteStreams.find(e=>e.peerId===this.pinnedPeerIdDisp);return e||(0!==this.remoteStreams.length?this.remoteStreams[0]:null)}setLocalStream(e){const[t]=e.getVideoTracks(),[a]=e.getAudioTracks();Object(c.m)(()=>{this.localVideoStreamTrack=t,this.localAudioStreamTrack=a})}setScreenStreamTrack(e){e instanceof MediaStreamTrack?this.localScreenStreamTrack=e:(this.localScreenStreamTrack.stop(),this.localScreenStreamTrack={})}addRemoteStream(e){Object(c.m)(()=>{const t=this.remoteStreams.find(t=>t.peerId===e.peerId);this.removeRemoteStream(t),this.remoteStreams.push(e)})}removeRemoteStreamByPeerId(e){Object(c.m)(()=>{const t=this.remoteStreams.find(t=>t.peerId===e);this.removeRemoteStream(t),this.syncState.delete(e),this.pinnedPeerId===e&&(this.pinnedPeerId="")})}removeRemoteStream(e){e&&this.remoteStreams.remove(e)}}Object(c.f)(p,{syncState:c.k,pinnedPeerId:c.k,localVideoStreamTrack:c.k.ref,localScreenStreamTrack:c.k.ref,localAudioStreamTrack:c.k.ref,remoteStreams:c.k.shallow,localStream:c.c,pinnedPeerIdDisp:c.c,pinnedStream:c.c});var f=p;class v{constructor(){this.bufferText="",this.lastMessage={},this.messages=[]}addMessage({text:e,timestamp:t,peerId:a},r,n){this.messages.push({id:`${a}-${t}`,text:e,dispDate:new Date(t).toLocaleTimeString().slice(0,5),thumb:r,dispName:n})}updateBuffer(e){Object(c.m)(()=>{this.lastMessage=e,this.bufferText=""})}}Object(c.f)(v,{bufferText:c.k,lastMessage:c.k.ref,messages:c.k.shallow});var S=v;class g{constructor(){this.items=[]}showChat(e){this._show(`${e.dispName} sent a chat`)}showJoin(e){this._show(`${e.dispName} joined`)}showLeave(e){this._show(`${e.dispName} left`)}_show(e){const t={id:Date.now(),text:e};this.items.push(t),setTimeout(()=>this.items.remove(t),1e3)}}Object(c.f)(g,{items:c.k.shallow});var E=g;var b=class{constructor(){this.ui=new d,this.user=new h,this.room=new f,this.chat=new S,this.notification=new E}},y=a(27),k=a.n(y),w=a(14),N=a.n(w),_=a(10),O=a(3),M=a(11),I=a(4);var C=class extends _.a{constructor(e){super(e),this._destroyVad=null;const{user:t,room:a,ui:r}=this.store;Object(c.l)(()=>[t.videoDeviceId,t.audioDeviceId],async([e,n])=>{const i=await O.a.getUserMedia({videoDeviceId:e,audioDeviceId:n}).catch(e=>r.handleGetUserMediaError(e));r.isError||(a.localStream instanceof MediaStream&&O.a.stopStream(a.localStream),r.isAppReady=!0,t.isVideoMuted&&O.a.setMuteVideoTracks(i,!0),t.isAudioMuted&&O.a.setMuteAudioTracks(i,!0),a.setLocalStream(i))}),Object(c.l)(()=>t.isVideoMuted,e=>O.a.setMuteVideoTracks(a.localStream,e)),Object(c.l)(()=>t.isAudioMuted,e=>O.a.setMuteAudioTracks(a.localStream,e)),Object(c.l)(()=>t.dispName,e=>localStorage.setItem("SkyWayConf.dispName",e)),Object(c.l)(()=>a.localStream,e=>{this._destroyVad&&this._destroyVad();const{destroy:a}=N()(I.a.getAudioCtx(window),e,{onUpdate(e){t.isSpeaking=0!==e}});this._destroyVad=a}),Object(c.p)(()=>r.isAppReady,async()=>{const e=await O.a.getUserDevices().catch(e=>r.handleUserError(e));r.isError||t.updateDevices(e)})}async onLoad({roomType:e,roomName:t}){const{user:a,ui:r,room:n}=this.store;r.setRoom({roomType:e,roomName:t});const i=localStorage.getItem("SkyWayConf.dispName");i&&(a.dispName=i);const o=await O.a.getUserDevices().catch(e=>r.handleUserError(e));if(!r.isError){if(a.updateDevices(o),a.isNoVideoDevices&&a.isNoAudioDevices){r.isAppReady=!0;const e=O.a.getFakeStream(I.a.getAudioCtx(window));n.setLocalStream(e)}navigator.mediaDevices.ondevicechange=async function(){const e=await O.a.getUserDevices().catch(e=>r.handleUserError(e));r.isError||a.updateDevices(e)},k.a.bind(["command+e","ctrl+e"],()=>(a.isVideoMuted=!a.isVideoMuted,!1)),k.a.bind(["command+d","ctrl+d"],()=>(a.isAudioMuted=!a.isAudioMuted,!1))}}async onClickJoinRoom(){const{ui:e,room:t,user:a}=this.store,r=await M.a.initPeer().catch(t=>e.handleAppError(t));if(e.isError)return;r.on("error",t=>e.handleSkyWayPeerError(t)),a.peerId=r.id;const n=r.joinRoom(`${e.roomType}/${e.roomName}`,{mode:e.roomType,stream:t.localStream});this._onRoomJoin(n),e.isSettingOpen=!1}async onChatEnterKeyDown(){const{chat:e,user:t,room:a,ui:r}=this.store;if(r.isChatSending)return;if(0===e.bufferText.length)return;r.isChatSending=!0;const n=await O.a.snapVideoStream(a.localStream,"image/jpeg",.5).catch(e=>r.handleAppError(e));if(r.isError)return;const i={peerId:t.peerId,text:e.bufferText,blob:n,timestamp:Date.now()},o=URL.createObjectURL(n);e.addMessage(i,o,t.dispName),e.updateBuffer(i),r.isChatSending=!1}async startScreenShare(){const{ui:e,room:t,user:a}=this.store;if(!1===M.a.isScreenShareAvailable())return void(e.isScreenShareIntroOpen=!0);let r;try{r=await M.a.getScreenStreamTrack()}catch(t){return t instanceof DOMException==0&&(e.isScreenShareIntroOpen=!0),void console.error(t)}r.addEventListener("ended",()=>this.stopScreenShare(),{once:!0}),a.isVideoMuted&&O.a.setMuteTrack(r,!0),t.setScreenStreamTrack(r),e.isScreenSharing=!0}stopScreenShare(){const{ui:e,room:t}=this.store;t.setScreenStreamTrack(null),e.isScreenSharing=!1}_onRoomJoin(e){const{ui:t,user:a,room:r,chat:n}=this.store;t.isRoomJoin=!0,e.on("stream",t=>this._onRoomAddStream(t,e)),e.on("removeStream",e=>this._onRoomRemoveStream(e)),e.on("peerLeave",e=>this._onRoomPeerLeave(e)),e.on("data",e=>this._onRoomData(e)),Object(c.l)(()=>r.localStream,()=>e.replaceStream(r.localStream)),Object(c.l)(()=>a.syncState,t=>e.send({type:"sync",payload:t})),Object(c.l)(()=>n.lastMessage,t=>e.send({type:"chat",payload:t}))}_onRoomAddStream(e,t){const{room:a,user:r,notification:n}=this.store;a.addRemoteStream(e),t.send({type:"sync",payload:r.syncState}),Object(c.p)(()=>void 0!==a.syncState.get(e.peerId),()=>n.showJoin(a.syncState.get(e.peerId)))}_onRoomRemoveStream(e){const{room:t}=this.store;t.removeRemoteStream(e)}_onRoomPeerLeave(e){const{room:t,notification:a}=this.store,r=t.syncState.get(e);a.showLeave(r),t.removeRemoteStreamByPeerId(e)}_onRoomData({_src:e,data:t}){const{room:a,chat:r,ui:n,notification:i}=this.store,{type:o,payload:s}=t;switch(o){case"sync":a.syncState.set(s.peerId,s);break;case"chat":{const e=a.syncState.get(s.peerId),t=new Blob([new Uint8Array(s.blob)]),o=URL.createObjectURL(t);r.addMessage(s,o,e.dispName),n.isChatOpen||i.showChat(e);break}default:throw new Error(`${o} is not defined as message type`)}}};var T=()=>n.a.createElement("div",{className:"Loader"},n.a.createElement("img",{className:"Loader_Image",src:"./images/conf/icon-loading.svg",alt:"Loading"}));var D=Object(s.c)(({ui:e})=>n.a.createElement("div",{className:"Error"},n.a.createElement("div",{className:"Error_Title"},n.a.createElement("i",{className:"material-icons"},"error"),n.a.createElement("span",null,"Error")),e.isUserError&&n.a.createElement("div",{className:"Error_Desc"},n.a.createElement("p",null,"Please check your.."),n.a.createElement("ul",null,n.a.createElement("li",null,"current url(and hash)"),n.a.createElement("li",null,"camera or microphone settings"),n.a.createElement("li",null,"network conditions"),n.a.createElement("li",null,"browser updates"))),e.isAppError&&n.a.createElement("div",{className:"Error_Desc"},n.a.createElement("p",null,"Sorry, currently our service is not available. Please try it later."))));var j=Object(s.b)("ui","action")(Object(s.c)(class extends n.a.Component{render(){const{ui:e,children:t}=this.props;return e.isError?n.a.createElement(D,{ui:e}):e.isAppReady?t:n.a.createElement(T,null)}componentDidCatch(e){this.props.action.$update("ui.isAppError",!0),console.error(e)}}));var L=Object(s.c)(class extends n.a.Component{constructor(){super(),this._ref=null}render(){const{muted:e,isMirror:t,stream:a}=this.props;return n.a.createElement("video",{className:`Video ${t?"-reverse":""}`,ref:e=>{this._ref=e},muted:e,autoPlay:!0})}componentDidMount(){this._ref&&this.props.stream instanceof MediaStream&&(this._ref.srcObject=this.props.stream)}componentWillReact(){this._ref&&this.props.stream instanceof MediaStream&&(this._ref.srcObject=this.props.stream)}});var A=Object(s.c)(({room:e})=>n.a.createElement("div",{className:"ScreenVideo"},e.pinnedStream?n.a.createElement(L,{stream:e.pinnedStream,muted:!0}):null));var x=Object(s.b)("room")(Object(s.c)(({room:e})=>n.a.createElement(A,{room:e})));var V=class extends n.a.Component{constructor(){super(),this._ref=null,this._disposer=null,this._checkListWidth=this._checkListWidth.bind(this)}render(){return n.a.createElement("div",{className:"MemberList"},n.a.createElement("div",{className:"MemberList_Arrow -left"},n.a.createElement("i",{className:"material-icons"},"chevron_left")),n.a.createElement("div",{ref:e=>this._ref=e,className:"MemberList_Scroller"},this.props.children),n.a.createElement("div",{className:"MemberList_Arrow -right"},n.a.createElement("i",{className:"material-icons"},"chevron_right")))}componentDidMount(){const{room:e}=this.props;this._disposer=Object(c.l)(()=>e.remoteStreams.length,()=>this._checkListWidth(),{fireImmediately:!0,delay:500}),window.addEventListener("resize",this._checkListWidth)}componentWillUnmount(){this._disposer(),window.removeEventListener("resize",this._checkListWidth)}_checkListWidth(){parseInt(getComputedStyle(this._ref).width)<Array.from(this._ref.children).reduce((e,t)=>e+parseInt(getComputedStyle(t).width),0)?this._ref.parentElement.classList.add("-scrollable"):this._ref.parentElement.classList.remove("-scrollable")}},R=a(6),P=a(5);var U=Object(s.c)(({ui:e,room:t,user:a,action:r})=>n.a.createElement("div",{className:"MemberVideo"},n.a.createElement("div",{className:"MemberVideo_Name"},a.dispName),n.a.createElement("div",{className:"MemberVideo_Media"},n.a.createElement("button",{onClick:()=>r.$update("user.isVideoMuted",!a.isVideoMuted),title:a.isVideoMuted?"Unmute":"Mute"},n.a.createElement(R.a,{isMuted:a.isVideoMuted})),n.a.createElement("button",{onClick:()=>r.$update("user.isAudioMuted",!a.isAudioMuted),title:a.isAudioMuted?"Unmute":"Mute"},n.a.createElement(P.a,{isMuted:a.isAudioMuted}))),n.a.createElement("div",{className:"MemberVideo_Settings"},n.a.createElement("button",{onClick:()=>r.$update("ui.isSettingOpen",!0),title:"Open settings"},n.a.createElement("i",{className:"material-icons"},"settings"))),n.a.createElement(L,{stream:t.localStream,muted:!0,isMirror:!1===e.isScreenSharing}))),$=a(9);var F=Object(s.c)(({room:e,action:t})=>n.a.createElement(n.a.Fragment,null,e.remoteStreams.map(a=>{const r=e.syncState.get(a.peerId);return n.a.createElement("div",{key:a.id,className:"MemberVideo",onClick:()=>t.$update("room.pinnedPeerId",a.peerId)},e.pinnedPeerIdDisp===a.peerId&&n.a.createElement("div",{className:"MemberVideo_Pinned"}),r?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"MemberVideo_Name"},r.dispName),n.a.createElement("div",{className:"MemberVideo_Media"},r.isVideoMuted&&n.a.createElement(R.a,{isMuted:!0}),r.isAudioMuted&&n.a.createElement(P.a,{isMuted:!0}),r.isSpeaking&&n.a.createElement($.a,{isSpeaking:!0}))):null,n.a.createElement(L,{stream:a}))})));var W=Object(s.c)(({action:e})=>n.a.createElement("div",{className:"MemberVideo"},n.a.createElement("a",{className:"MemberVideo_Invite",onClick:()=>e.$update("ui.isInviteOpen",!0)},n.a.createElement("i",{className:"material-icons -x15"},"person_add"))));var q=Object(s.b)("ui","room","user","action")(Object(s.c)(({ui:e,room:t,user:a,action:r})=>n.a.createElement(V,{room:t},n.a.createElement(U,{ui:e,room:t,user:a,action:r}),n.a.createElement(F,{room:t,action:r}),n.a.createElement(W,{action:r}))));var B=Object(s.c)(({isVisible:e,children:t})=>e?n.a.createElement("div",{className:"Popup"},t):null);var K=Object(s.c)(({ui:e,room:t})=>n.a.createElement(L,{stream:t.localStream,muted:!0,isMirror:!1===e.isScreenSharing}));var J=Object(s.c)(({ui:e,user:t,action:a})=>n.a.createElement("div",{className:"DeviceSelector"},n.a.createElement("div",{className:"DeviceSelector_Row"},n.a.createElement("div",{className:"DeviceSelector_Label"},"Cam"),n.a.createElement("select",{className:"DeviceSelector_Select",value:t.videoDeviceId,onChange:e=>a.$update("user.videoDeviceId",e.target.value),disabled:e.isScreenSharing||t.isNoVideoDevices},t.isNoVideoDevices&&n.a.createElement("option",{value:""},"Cam not found"),t.videoDevices.map((e,t)=>n.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||`Cam ${t+1}`))),n.a.createElement("button",{onClick:()=>a.$update("user.isVideoMuted",!t.isVideoMuted),title:t.isVideoMuted?"Unmute":"Mute"},n.a.createElement(R.a,{isMuted:t.isVideoMuted}))),n.a.createElement("div",{className:"DeviceSelector_Row"},n.a.createElement("div",{className:"DeviceSelector_Label"},"Mic"),n.a.createElement("select",{className:"DeviceSelector_Select",value:t.audioDeviceId,onChange:e=>a.$update("user.audioDeviceId",e.target.value),disabled:e.isScreenSharing||t.isNoAudioDevices},t.isNoAudioDevices&&n.a.createElement("option",{value:""},"Mic not found"),t.audioDevices.map((e,t)=>n.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label||`Mic ${t+1}`))),n.a.createElement("button",{onClick:()=>a.$update("user.isAudioMuted",!t.isAudioMuted),title:t.isAudioMuted?"Unmute":"Mute"},n.a.createElement(P.a,{isMuted:t.isAudioMuted})),n.a.createElement("div",{className:"DeviceSelector_Va"},n.a.createElement($.a,{isSpeaking:t.isSpeaking}))),e.isScreenSharing&&n.a.createElement("p",{className:"DeviceSelector_Notice"},"You can not change devices during screen sharing.")));var z=Object(s.c)(({user:e,action:t})=>n.a.createElement("div",{className:"NameEdit"},n.a.createElement("div",{className:"NameEdit_Label"},"Name"),n.a.createElement("input",{className:"NameEdit_Input",type:"text",maxLength:10,value:e.dispName,onChange:e=>t.$update("user.dispName",e.target.value)})));var H=Object(s.b)("room","ui","user","action")(Object(s.c)(({room:e,ui:t,user:a,action:r})=>n.a.createElement(B,{isVisible:t.isSettingOpen},n.a.createElement("div",{className:"L-Setting"},n.a.createElement("div",{className:"L-Setting_Video"},n.a.createElement(K,{ui:t,room:e})),n.a.createElement(J,{ui:t,user:a,action:r}),n.a.createElement(z,{user:a,action:r}),n.a.createElement("div",{className:"L-Setting_Finish"},n.a.createElement("button",{onClick:e=>{t.isRoomJoin?r.$update("ui.isSettingOpen",!1):(e.target.disabled=!0)&&r.onClickJoinRoom()}},"OK"))))));var Y=Object(s.b)("ui","action")(Object(s.c)(({ui:e,action:t})=>n.a.createElement(B,{isVisible:e.isInviteOpen},n.a.createElement("div",{className:"L-Invite"},n.a.createElement("h3",{className:"L-Invite_Title"},"Share the link"),n.a.createElement("input",{type:"text",className:"L-Invite_Input",readOnly:!0,defaultValue:e.confUrl,onClick:e=>e.target.select(0,-1)}),n.a.createElement("div",{className:"L-Invite_Finish"},n.a.createElement("button",{onClick:()=>t.$update("ui.isInviteOpen",!1)},"Close"))))));var G=Object(s.b)("ui","action")(Object(s.c)(({ui:e,action:t})=>!e.isChatOpen&&n.a.createElement("button",{onClick:()=>t.$update("ui.isChatOpen",!0),title:"Open chat"},n.a.createElement("i",{className:"material-icons"},"chat"))));var X=Object(s.c)(class extends n.a.Component{constructor(){super(),this._ref=null}render(){const{chat:e}=this.props;return n.a.createElement("ul",{className:"ChatMessageList",ref:e=>this._ref=e},e.messages.map(e=>n.a.createElement("li",{key:e.id},n.a.createElement("div",{className:"ChatMessageList_Item"},n.a.createElement("div",{className:"ChatMessageList_Item_Thumb"},n.a.createElement("img",{className:"ChatMessageList_Item_Thumb_Image",src:e.thumb})),n.a.createElement("div",{className:"ChatMessageList_Item_Content"},n.a.createElement("div",{className:"ChatMessageList_Item_Content_Head"},n.a.createElement("span",{className:"ChatMessageList_Item_Content_HeadName"},e.dispName),n.a.createElement("span",{className:"ChatMessageList_Item_Content_HeadDate"},"at ",e.dispDate)),n.a.createElement("p",{className:"ChatMessageList_Item_Content_Body"},e.text))))))}componentWillReact(){this._ref&&requestAnimationFrame(()=>this._ref.scrollTop=this._ref.scrollHeight)}});var Q=Object(s.c)(({chat:e,action:t})=>n.a.createElement("div",{className:"ChatBox"},n.a.createElement("a",{className:"ChatBox_Closer",onClick:()=>t.$update("ui.isChatOpen",!1)},n.a.createElement("i",{className:"material-icons -x05"},"keyboard_arrow_right")),n.a.createElement(X,{chat:e}),n.a.createElement("input",{className:"ChatBox_Input",type:"text",placeholder:"Type messages here...",value:e.bufferText,onChange:e=>t.$update("chat.bufferText",e.target.value),onKeyDown:e=>13===e.keyCode&&t.onChatEnterKeyDown()})));var Z=Object(s.b)("ui","chat","action")(Object(s.c)(({ui:e,chat:t,action:a})=>n.a.createElement("div",{className:"L-ChatBox"},e.isChatOpen&&n.a.createElement(Q,{ui:e,chat:t,action:a}))));var ee=Object(s.b)("ui","action")(Object(s.c)(({ui:e,action:t})=>e.isScreenSharing?n.a.createElement("button",{onClick:()=>t.stopScreenShare(),title:"Stop screen share"},n.a.createElement("i",{className:"material-icons"},"stop_screen_share")):n.a.createElement("button",{onClick:()=>t.startScreenShare(),title:"Start screen share"},n.a.createElement("i",{className:"material-icons"},"screen_share"))));var te=Object(s.b)("ui","action")(Object(s.c)(({ui:e,action:t})=>n.a.createElement(B,{isVisible:e.isScreenShareIntroOpen},n.a.createElement("div",{className:"L-ScreenShareIntro"},n.a.createElement("h3",{className:"L-ScreenShareIntro_Title"},"ScreenShare is not available"),n.a.createElement("p",{className:"L-ScreenShareIntro_Desc"},"Screen share is not supported on your browser. If you are using Chrome, please install"," ",n.a.createElement("a",{href:"https://chrome.google.com/webstore/detail/conf3-screenshare/ooeacgahemnciocfilnkchjjiakipakp",target:"_blank",rel:"noopener noreferrer"},"Chrome extension"),"."),n.a.createElement("div",{className:"L-ScreenShareIntro_Finish"},n.a.createElement("button",{onClick:()=>t.$update("ui.isScreenShareIntroOpen",!1)},"Close"))))));var ae=Object(s.c)(({notification:e})=>n.a.createElement(n.a.Fragment,null,e.items.map(e=>n.a.createElement("div",{className:"Toast",key:e.id},e.text))));var re=Object(s.b)("notification")(Object(s.c)(({notification:e})=>n.a.createElement("div",{className:"L-Notification"},n.a.createElement(ae,{notification:e}))));var ne=()=>n.a.createElement(j,null,n.a.createElement("main",{className:"L-Main"},n.a.createElement(x,null),n.a.createElement(q,null)),n.a.createElement(H,null),n.a.createElement(Y,null),n.a.createElement("div",{className:"L-RightSide"},n.a.createElement(ee,null),n.a.createElement(G,null)),n.a.createElement(Z,null),n.a.createElement(te,null),n.a.createElement(re,null)),ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};!function(){const[,e,t]=location.hash.split("/"),a=I.a.getOsName(navigator.userAgent),r=I.a.getBrowserName(navigator.userAgent);if(!1===(["Windows","Mac","iOS","Android"].includes(a)&&["Chrome","Firefox","Safari"].includes(r))||"Safari"===r&&"mesh"!==e)return void(location.href="./not_supported.html");if(["iOS","Android"].includes(a))return void(location.href=`./conf_mobile.html${location.hash}`);const i=new b,c=new C(i);c.onLoad({roomType:e,roomName:t}),o.a.render(n.a.createElement(s.a,ie({action:c},i),n.a.createElement(ne,null)),document.getElementById("app-root")),window.addEventListener("hashchange",()=>location.reload(!0))}()}]);